<!DOCTYPE html>
<html lang="pt-BR">
<head>
<script id="bihub-data">window.__BI_VENDAS__    = [{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"AGUA COM GAS","qty":1982,"val":25766},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"AGUA SEM GAS","qty":2836,"val":36868},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"AGUA TONICA","qty":30,"val":315},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"COCA COLA COMUM","qty":298,"val":3874},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"COCA COLA ZERO","qty":1128,"val":14664},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"RED BULL","qty":26,"val":404},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"RED BULL SUGAR FREE","qty":17,"val":259},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"GUARANA COMUM","qty":88,"val":1144},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"GUARANA ZERO","qty":239,"val":3107},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"AGUA SAN PELLEGRINO","qty":270,"val":8668},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"AGUA PANNA 505ML","qty":352,"val":11306},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"MATE NATURAL DA CASA","qty":264,"val":3488},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"AGUA TONICA ZERO","qty":43,"val":559},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"LIMONADA SUICA","qty":93,"val":1495},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"SUCO DE ABACAXI COM HORTELA","qty":96,"val":1549},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"SUCO DE MELAO","qty":30,"val":480},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"SUCO DE LARANJA","qty":206,"val":3312},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"LIMONADA COMUM","qty":64,"val":1027},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"SUCO DE ABACAXI","qty":57,"val":915},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"SODA GENGIBRE E FRAMBOESA","qty":34,"val":739},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"SODA MELON DROP","qty":30,"val":750},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"SODA LICHIA","qty":11,"val":278},{"cat":"BEBIDAS NAO ALCOOLICAS","prod":"LIMONETO","qty":7,"val":91},{"cat":"CAFE E CHA","prod":"NESPRESSO BRASIL","qty":11,"val":125},{"cat":"CAFE E CHA","prod":"NESPRESSO DESCAFEINADO","qty":86,"val":1010},{"cat":"CAFE E CHA","prod":"CHA VERDE","qty":73,"val":0.73},{"cat":"CAFE E CHA","prod":"CHA JASMIN","qty":58,"val":0.58},{"cat":"CAFE E CHA","prod":"CHA DE HIBISCO","qty":52,"val":841},{"cat":"CAFE E CHA","prod":"CHA HORTELA","qty":80,"val":0.8},{"cat":"CAFE E CHA","prod":"CAFE NESPRESSO NEPAL","qty":806,"val":9250},{"cat":"CERVEJAS","prod":"SAPPORO LONG NECK","qty":408,"val":16440},{"cat":"CERVEJAS","prod":"HEINEKEN LONG NECK","qty":621,"val":11178},{"cat":"CERVEJAS","prod":"HEINEKEN 0.0 LONG NECK","qty":31,"val":558},{"cat":"CERVEJAS","prod":"BLUE MOON LONG NECK","qty":71,"val":1784},{"cat":"CERVEJAS","prod":"LAGUNITAS LONG NECK","qty":91,"val":2275},{"cat":"CERVEJAS","prod":"PRAYA LAGER LONG NECK","qty":267,"val":4858},{"cat":"ACOMPANHAMENTO","prod":"AC. YAKIMESHI DE LEGUMES","qty":52,"val":2220},{"cat":"ACOMPANHAMENTO","prod":"AC. YAKIMESHI SHITAKE","qty":7,"val":364},{"cat":"ACOMPANHAMENTO","prod":"AC. GOHAN","qty":75,"val":1431},{"cat":"ACOMPANHAMENTO","prod":"AC. MISSOSHIRO","qty":28,"val":784},{"cat":"ACOMPANHAMENTO","prod":"AC. MOLHO TATAKI","qty":1,"val":5},{"cat":"ACOMPANHAMENTO","prod":"AC. CRISP DE NORI E SHOYO","qty":1,"val":14},{"cat":"CERVEJAS","prod":"HEINEKEN ZERO 330ML","qty":12,"val":216},{"cat":"ENTRADA FRIA","prod":"CARPACCIO VIEIRA","qty":174,"val":14688},{"cat":"ENTRADA FRIA","prod":"CARPACCIO DE POLVO QUENTE","qty":32,"val":2325},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI CRISPY RICE ATUM","qty":179,"val":4881},{"cat":"ENTRADA FRIA","prod":"TARTAR DE SALMAO","qty":144,"val":8862},{"cat":"ENTRADA FRIA","prod":"SUNOMONO","qty":160,"val":5216},{"cat":"ENTRADA FRIA","prod":"TARTAR DE ATUM","qty":32,"val":1958},{"cat":"ENTRADA FRIA","prod":"TARTAR DE ATUM CAIPIRA","qty":720,"val":49818},{"cat":"ENTRADA FRIA","prod":"ATUM VERMELHO PICANTE","qty":113,"val":7506},{"cat":"ENTRADA FRIA","prod":"SASHIMI MORNO","qty":9,"val":756},{"cat":"ENTRADA FRIA","prod":"TUNA SALAD","qty":21,"val":1631},{"cat":"ENTRADA FRIA","prod":"SALMAO EM CUBOS","qty":234,"val":16080},{"cat":"ENTRADA FRIA","prod":"TAKO TRUFFLE - POLVO EM CUBOS","qty":53,"val":5807},{"cat":"ENTRADA FRIA","prod":"CARPACCIO SALMAO FRANCA","qty":37,"val":3330},{"cat":"USSUZUKURI E TATAKI","prod":"CARPACCIO SALMAO FRANCA","qty":357,"val":29274},{"cat":"USSUZUKURI E TATAKI","prod":"TATAKI ATUM","qty":53,"val":3510},{"cat":"ENTRADA FRIA","prod":"MINI TACO","qty":206,"val":8740},{"cat":"SASHIMI TRADICIONAL","prod":"SASHIMI ATUM SELADO SPICY","qty":61,"val":3395},{"cat":"ENTRADA FRIA","prod":"SALMAO MARINADO BALSAMICO","qty":2,"val":78},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI CRISPY RICE SALMAO","qty":270,"val":7120},{"cat":"ENTRADA FRIA","prod":"TARTAR DE NAMORADO SPICY","qty":45,"val":2213},{"cat":"ENTRADA FRIA","prod":"POLVO CROCK","qty":102,"val":3771},{"cat":"ENTRADA QUENTE","prod":"MISSOSHIRO","qty":309,"val":8756},{"cat":"ENTRADA QUENTE","prod":"SHIMEJI","qty":104,"val":6072},{"cat":"ENTRADA QUENTE","prod":"SHITAKE","qty":48,"val":2799},{"cat":"ENTRADA QUENTE","prod":"HARUMAKI DE EBI CAMARAO","qty":185,"val":9177},{"cat":"ENTRADA QUENTE","prod":"GUIOZA SUINA","qty":333,"val":12423},{"cat":"ENTRADA QUENTE","prod":"CHIPS BATATA DOCE SPICY","qty":89,"val":2682},{"cat":"ENTRADA QUENTE","prod":"NIRA","qty":214,"val":9913},{"cat":"ENTRADA QUENTE","prod":"ATUM SELADO PONZU E GEMA DE OVO","qty":132,"val":6048},{"cat":"ENTRADA QUENTE","prod":"STICKY SALMAO ROLL","qty":122,"val":6098},{"cat":"ENTRADA QUENTE","prod":"SPICY TUNA NO SHISO","qty":134,"val":8148},{"cat":"ENTRADA QUENTE","prod":"CAMARAO POPS","qty":358,"val":24924},{"cat":"ENTRADA QUENTE","prod":"SHIMEJI SHITAKE MISTO","qty":68,"val":3979},{"cat":"ENTRADA QUENTE","prod":"EDAMAME","qty":534,"val":19334},{"cat":"ENTRADA QUENTE","prod":"GUIOZA VEGETARIANA","qty":125,"val":4676},{"cat":"ENTRADA QUENTE","prod":"TEMPURA DE MILHO","qty":177,"val":6948},{"cat":"ENTRADA QUENTE","prod":"BAO DE TORI","qty":117,"val":3906},{"cat":"COMBINADO","prod":"COMBINADO TUNA SAL","qty":50,"val":14587},{"cat":"COMBINADO","prod":"COMBINADO SELECAO 26 PECAS - SUSHI BAR","qty":381,"val":104262},{"cat":"COMBINADO","prod":"COMBINADO SELECAO BASICA 41 PECAS","qty":271,"val":68350},{"cat":"COMBINADO","prod":"SELECAO DO CHEF 12 UN","qty":99,"val":16983},{"cat":"COMBINADO","prod":"COMBINADO SASHIMI 28 PECAS - DIVERSOS","qty":68,"val":14556},{"cat":"COMBINADO","prod":"SELECAO BLUEFIN TORO","qty":1,"val":184},{"cat":"COMBINADO","prod":"SELECAO BLUEFIN AKAMI","qty":19,"val":1893},{"cat":"COZINHA CLASSICOS","prod":"FURAI MIGNON","qty":3,"val":186},{"cat":"COZINHA CLASSICOS","prod":"FURAI FRANGO","qty":41,"val":2454},{"cat":"COZINHA CLASSICOS","prod":"TEMPURA CAMARAO","qty":44,"val":11560},{"cat":"COZINHA CLASSICOS","prod":"TEMPURA MISTO","qty":3,"val":540},{"cat":"COZINHA CLASSICOS","prod":"MEIO TEMPURA CAM","qty":15,"val":2550},{"cat":"COZINHA CLASSICOS","prod":"TEPPAN YAKI CAMARAO","qty":4,"val":462},{"cat":"COZINHA CLASSICOS","prod":"TEPPAN YAKI NAMORADO","qty":10,"val":750},{"cat":"COZINHA CLASSICOS","prod":"TEPPAN YAKI DE LEGUMES","qty":2,"val":98},{"cat":"COZINHA CLASSICOS","prod":"YAKISAKANA NAMORADO","qty":1,"val":98},{"cat":"COZINHA CLASSICOS","prod":"YAKISAKANA SALMAO","qty":5,"val":295},{"cat":"COZINHA CLASSICOS","prod":"YAKISSOBA LEGUMES","qty":25,"val":1589},{"cat":"COZINHA CLASSICOS","prod":"YAKISSOBA MIGNON","qty":104,"val":8138},{"cat":"COZINHA CLASSICOS","prod":"YAKISSOBA FRANGO","qty":17,"val":1007},{"cat":"COZINHA CLASSICOS","prod":"YAKISSOBA SALMAO","qty":5,"val":371},{"cat":"COZINHA CLASSICOS","prod":"YAKISSOBA CAMARAO VG","qty":2,"val":538},{"cat":"COZINHA CLASSICOS","prod":"NAMORADO COM PURE DE TOFU","qty":20,"val":1989},{"cat":"ENTRADA QUENTE","prod":"SALMAO FOIE MARINADO NO MISSO","qty":66,"val":6615},{"cat":"COZINHA CLASSICOS","prod":"TEMPURA DE LEGUMES","qty":26,"val":2410},{"cat":"COZINHA ESPECIAIS","prod":"TEPPAN YAKI DE MIGNON","qty":59,"val":5208},{"cat":"COZINHA ESPECIAIS","prod":"TEPPAN YAKI DE SALMAO","qty":55,"val":4880},{"cat":"ENTRADA QUENTE","prod":"ATUM SEMI GRELHADO COM FOIE","qty":216,"val":32784},{"cat":"COZINHA ESPECIAIS","prod":"YAKIMESHI CAMARAO BABY","qty":29,"val":2109},{"cat":"COZINHA ESPECIAIS","prod":"DOBIN MOSHI","qty":1,"val":25},{"cat":"COZINHA ESPECIAIS","prod":"AGUE DOFU","qty":5,"val":160},{"cat":"EXECUTIVO","prod":"EXECUTIVO POKE TIRASHI","qty":35,"val":2431.72},{"cat":"EXECUTIVO","prod":"EXECUTIVO COMBINADO 14 PECAS SUSHI MAKI","qty":56,"val":3640},{"cat":"MAKI","prod":"MAKI SALMAO LIGHT","qty":53,"val":2458},{"cat":"MAKI","prod":"MAKI SALMAO","qty":77,"val":1876},{"cat":"MAKI","prod":"KAPPA MAKI","qty":15,"val":320},{"cat":"MAKI","prod":"SALMAO SKIN MAKI","qty":15,"val":426},{"cat":"MAKI","prod":"FILADELFIA ESPECIAL","qty":270,"val":14195},{"cat":"MAKI","prod":"SPICY TUNA MAKI","qty":3,"val":87},{"cat":"MAKI","prod":"SPICY SALMON MAKI","qty":2,"val":60},{"cat":"MAKI","prod":"SALMAO SKIN ESPECIAL","qty":26,"val":870},{"cat":"MAKI","prod":"SPICY TUNA AVOCADO","qty":192,"val":9705},{"cat":"MAKI","prod":"CALIFORNIA","qty":24,"val":564},{"cat":"MAKI","prod":"HOT MAKI","qty":343,"val":24827},{"cat":"MAKI","prod":"FILADELFIA","qty":599,"val":30240},{"cat":"MAKI","prod":"ASPARGO SALMAO ROLL","qty":72,"val":3769},{"cat":"MAKI","prod":"SPICY TUNA URAMAKI","qty":5,"val":180},{"cat":"MAKI","prod":"SALMAO URAMAKI","qty":35,"val":1059},{"cat":"MAKI","prod":"URAMAKI SALMAO SKIN","qty":9,"val":267},{"cat":"MAKI","prod":"URAMAKI SPICY SALMAO","qty":10,"val":353},{"cat":"MAKI","prod":"HOT QUINOA","qty":245,"val":12133},{"cat":"MAKI","prod":"SPICY CAMARAO","qty":294,"val":20616},{"cat":"MAKI","prod":"TEKKA MAKI","qty":19,"val":477},{"cat":"MAKI","prod":"SPICY TUNA AVOCADO CRISP","qty":111,"val":4254},{"cat":"MAKI","prod":"BATERA BLACK COD","qty":81,"val":4191},{"cat":"MAKI","prod":"BATERA DE SALMAO","qty":178,"val":8734},{"cat":"MAKI","prod":"BARRIGA ROLL","qty":516,"val":28164},{"cat":"MAKI","prod":"BATERA DE ATUM","qty":52,"val":2536},{"cat":"MAKI","prod":"MAKI VEGGIE","qty":28,"val":995},{"cat":"MAKI","prod":"MAGURO TRUFFLE","qty":171,"val":13122},{"cat":"MAKI","prod":"CENTOLLA AVOCADO","qty":119,"val":8995},{"cat":"MAKI","prod":"YELLOWTAIL ROLL","qty":104,"val":7790},{"cat":"ROBATA","prod":"ROBATA DE MIGNON","qty":10,"val":450},{"cat":"ROBATA","prod":"ROBATA FRANGO","qty":8,"val":200},{"cat":"ROBATA","prod":"ROBATA CAMARAO","qty":5,"val":325},{"cat":"ROBATA","prod":"ROBATA LULA","qty":5,"val":171},{"cat":"ROBATA","prod":"ROBATA ASPARGOS","qty":1,"val":34},{"cat":"SAZONAL","prod":"DUPLA GRACAINHA","qty":1,"val":16},{"cat":"SAZONAL","prod":"DUPLA PESCADA AMARELA","qty":5,"val":120},{"cat":"SAZONAL","prod":"DUPLA CAVALA","qty":7,"val":119},{"cat":"SAZONAL","prod":"DUPLA LULA","qty":4,"val":107},{"cat":"SAZONAL","prod":"DUPLA DOURADO","qty":2,"val":36},{"cat":"SAZONAL","prod":"DUPLA SUSHI TORO","qty":5,"val":230},{"cat":"SAZONAL","prod":"DUPLA SUSHI CHU TORO","qty":16,"val":608},{"cat":"SAZONAL","prod":"DUPLA BURI GORDO","qty":16,"val":414},{"cat":"SAZONAL","prod":"SASHIMI PESC AMARELA","qty":1,"val":29},{"cat":"SAZONAL","prod":"SASHIMI LULA","qty":11,"val":501},{"cat":"SAZONAL","prod":"SASHIMI DE BLUEFIN CHUTORO","qty":29,"val":2515},{"cat":"SAZONAL","prod":"SASHIMI DE BLUEFIN AKAMI","qty":41,"val":3405},{"cat":"SAZONAL","prod":"SASHIMI DE BLUEFIN TORO","qty":3,"val":255},{"cat":"SAZONAL","prod":"SASHIMI CHU TORO","qty":5,"val":365},{"cat":"SAZONAL","prod":"DUPLA CAVAQUINHA","qty":1,"val":39},{"cat":"SAZONAL","prod":"SASHIMI OLHO DE CAO","qty":5,"val":125},{"cat":"SAZONAL","prod":"D OLHO DE CAO","qty":1,"val":19},{"cat":"SUGESTOES","prod":"MIX TEMPURA VEGGIE","qty":3,"val":90},{"cat":"SUSHI ESPECIAL","prod":"GUNKAN DE ENGUIA E ABACATE","qty":82,"val":3690},{"cat":"SUGESTOES","prod":"SASHIMI NAMORADO SPICY COM CRISPY","qty":20,"val":720},{"cat":"SUSHI ESPECIAL","prod":"SUSHI DE VIEIRA MASSARICADA E MOLHO TATAKI","qty":34,"val":1428},{"cat":"SUGESTOES","prod":"LULA RECHEADA","qty":24,"val":2280},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI NAMORADO SPICY","qty":30,"val":906},{"cat":"SUGESTOES","prod":"SASHIMI MISTO NO MISSO CITRICO","qty":4,"val":164},{"cat":"SASHIMI ESPECIAL","prod":"BARRIGA DE SALMAO NO MISSO CITRICO","qty":69,"val":4452},{"cat":"SUSHI ESPECIAL","prod":"SUSHI DE UNI TEMPERADO","qty":13,"val":741},{"cat":"SUGESTOES","prod":"DUPLA SUSHI DE HADDOCK DEFUMADO","qty":19,"val":456},{"cat":"ENTRADA FRIA","prod":"ATUM SEMI CRU COM SALADA DE BIFUM E FAROFA","qty":33,"val":1825},{"cat":"USSUZUKURI E TATAKI","prod":"TATAKI DE MIGNON COM COGUMELOS ERYNGUI","qty":23,"val":2148},{"cat":"ENTRADA QUENTE","prod":"CAMARAO SWEET CHILLI","qty":149,"val":10920},{"cat":"COZINHA ESPECIAIS","prod":"PEIXE DO DIA COM PURE DE COUVE FLOR E TOFU","qty":1,"val":99},{"cat":"COZINHA ESPECIAIS","prod":"FRIED RICE - ARROZ COM COSTELA MARINADA","qty":67,"val":4031},{"cat":"SUGESTOES","prod":"KOROKKE BLACK COD","qty":22,"val":770},{"cat":"SUGESTOES","prod":"BAO DE CAMARAO","qty":131,"val":7295},{"cat":"SUGESTOES","prod":"CROCANTE DE ARROZ NEGRO COM LAGOSTIN","qty":78,"val":6552},{"cat":"ST MAKI","prod":"ST. SALMAO LIGHT","qty":17,"val":867},{"cat":"SOUVENIR","prod":"ADICIONAL EXTRA","qty":8,"val":40},{"cat":"SOUVENIR","prod":"LC SUSHI","qty":746,"val":746},{"cat":"SOUVENIR","prod":"TAXA DE ROLHA","qty":20,"val":1600},{"cat":"SOUVENIR","prod":"PRODUTO EXTRA","qty":3,"val":846},{"cat":"SASHIMI TRADICIONAL","prod":"SASHIMI ATUM","qty":260,"val":10227},{"cat":"SASHIMI TRADICIONAL","prod":"SASHIMI SALMAO","qty":512,"val":20127},{"cat":"SASHIMI TRADICIONAL","prod":"SASHIMI BURI","qty":4,"val":188},{"cat":"SASHIMI TRADICIONAL","prod":"SASHIMI ROBALO","qty":9,"val":387},{"cat":"SASHIMI TRADICIONAL","prod":"SASHIMI NAMORADO","qty":42,"val":1624},{"cat":"SASHIMI TRADICIONAL","prod":"SASHIMI POLVO","qty":63,"val":4008},{"cat":"SASHIMI TRADICIONAL","prod":"SASHIMI XERELETE","qty":8,"val":344},{"cat":"SASHIMI TRADICIONAL","prod":"SASHIMI CAVALA","qty":2,"val":48},{"cat":"SASHIMI TRADICIONAL","prod":"SASHIMI AGULHAO BRANCO","qty":25,"val":981},{"cat":"SASHIMI TRADICIONAL","prod":"SASHIMI AGULHAO TRUFADO","qty":42,"val":1458},{"cat":"SASHIMI TRADICIONAL","prod":"SASHIMI BARRIGA DE SALMAO","qty":51,"val":3270},{"cat":"SASHIMI TRADICIONAL","prod":"SASHIMI VIEIRA","qty":35,"val":2894},{"cat":"SASHIMI ESPECIAL","prod":"SASHIMI NAMORADO SPICY","qty":4,"val":172},{"cat":"SASHIMI ESPECIAL","prod":"SASHIMI CAVALINHA","qty":1,"val":45},{"cat":"SASHIMI ESPECIAL","prod":"SASHIMI SALMAO GRAVLAX","qty":60,"val":2976},{"cat":"SASHIMI ESPECIAL","prod":"SASHIMI POLVO TRUFADO","qty":11,"val":750},{"cat":"SASHIMI ESPECIAL","prod":"SASHIMI SALMAO QUINOA CROCANTE","qty":440,"val":21756},{"cat":"SASHIMI ESPECIAL","prod":"SASHIMI SALMAO SELADO","qty":53,"val":2024},{"cat":"SASHIMI ESPECIAL","prod":"SASHIMI KING CRAB","qty":37,"val":3095},{"cat":"SASHIMI ESPECIAL","prod":"SASHIMI SALMAO SICILIANO","qty":4,"val":144},{"cat":"SASHIMI ESPECIAL","prod":"SASHIMI YELLOWTAIL BLUEFIN TORO","qty":50,"val":3714},{"cat":"SASHIMI ESPECIAL","prod":"SASHIMI MAGURO BLUEFIN CHUTORO","qty":10,"val":1007},{"cat":"SASHIMI ESPECIAL","prod":"SASHIMI MAGURO BLUEFIN TORO","qty":3,"val":342},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA IKURA CODORNA","qty":8,"val":416},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SALMAO IKURA","qty":6,"val":468},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA LULA C FLOR DE SAL","qty":2,"val":48},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA BARRIGA SALMAO","qty":215,"val":5832},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI ATUM","qty":238,"val":5788},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI SALMAO","qty":406,"val":9884},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI BURI","qty":26,"val":626},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI ROBALO","qty":9,"val":171},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI NAMORADO","qty":52,"val":1296},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI PARGO","qty":3,"val":69},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI XERELETE","qty":9,"val":193},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI CAMARAO","qty":54,"val":1628},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI POLVO","qty":38,"val":1110},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI IKURA","qty":119,"val":8974},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI MASSAGO","qty":49,"val":2233},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI AGULHAO BRANCO","qty":43,"val":1090},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI SPICY TUNA","qty":33,"val":866},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI SPICY SALMAO","qty":15,"val":390},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI SALMAO ESPECIAL CRUNCH","qty":123,"val":3416},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI SALMAO SKIN","qty":72,"val":1336},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI SHITAKE","qty":5,"val":110},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI VIEIRA","qty":189,"val":11236},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI SHIMEJI","qty":17,"val":386},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI SPICY TUNA CRUNCH","qty":2,"val":46},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SPICY SALMAO CRUNCH","qty":1,"val":24},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI ATUM ESPECIAL CRUNCH","qty":18,"val":486},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI TOFU","qty":11,"val":300},{"cat":"SUSHI ESPECIAL","prod":"DUPLA OURICO CODORNA","qty":1,"val":44},{"cat":"SUSHI ESPECIAL","prod":"DUPLA OURICO","qty":81,"val":4842},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI UNI TEMPERADO","qty":4,"val":246},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI OURICO LIMAO","qty":8,"val":523.3},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI SALMAO GRAVLAX","qty":139,"val":3782},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI MAGURO TAMAGO","qty":64,"val":2204},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI NAMORADO SPICY","qty":5,"val":150},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI SALMAO COM FOIE GRAS","qty":171,"val":7568},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI ENGUIA UNAGUI","qty":102,"val":8514},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI CAVALINHA","qty":5,"val":115},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI SALMAO SKIN ESPECIAL","qty":35,"val":835},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI SALMAO SICILIANO","qty":203,"val":5756},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI MAGURO ZUKE","qty":43,"val":1057},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI POLVO AZ TRUF FLOR SAL","qty":2,"val":74},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI VIEIRA COM LICHIA","qty":86,"val":5392},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI PEIXE MANTEIGA","qty":71,"val":1872},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI FOIE GRAS BRULEE","qty":124,"val":9936},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI OVO DE CODORNA","qty":779,"val":19647},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI BLUEFIN TORO","qty":4,"val":320},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI BLUEFIN CHUTORO","qty":84,"val":5778},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI BLUEFIN AKAMI","qty":102,"val":3591},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI ATUM SELADO","qty":32,"val":840},{"cat":"SUSHI TRADICIONAL","prod":"DUPLA SUSHI SALMAO SELADO","qty":280,"val":7340},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI CAMARAO SELADO","qty":57,"val":1440},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI BARRIGA SALMAO FOIE GRAS","qty":88,"val":3819},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI KING CRAB","qty":63,"val":3936},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI POLVO C SALMAO","qty":6,"val":216},{"cat":"SUSHI ESPECIAL","prod":"DUPLA VIEIRA MACARICADA","qty":14,"val":868},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI VIEIRA C SALMAO","qty":335,"val":14738},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI SALMAO QUINOA CROCANTE","qty":454,"val":11966},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI VIEIRA GRELHADA COM GUACAMOLE DE PAPAI","qty":12,"val":750},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI VIEIRA GRELHADA COM GUACAMOLE DE PAPAIA","qty":50,"val":3136},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI GUNKAN ENGUIA E ABACATE","qty":7,"val":331},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI AGULHAO TRUFADO","qty":385,"val":10976},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI ATUM COM FOIE GRAS","qty":112,"val":4896},{"cat":"SUSHI ESPECIAL","prod":"D SUSHI MAGURO TAMAGO OVO E ATUM","qty":16,"val":564},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI GUNKAN IKURA","qty":20,"val":1588},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI LAGOSTIM","qty":183,"val":12444},{"cat":"SUSHI ESPECIAL","prod":"DUPLA SUSHI GUNKAN CENTOLLA","qty":105,"val":4648},{"cat":"TEMAKIS","prod":"TEMAKI ATUM","qty":56,"val":2400},{"cat":"TEMAKIS","prod":"TEMAKI ATUM ESPECIAL CRUNCH","qty":2,"val":86},{"cat":"TEMAKIS","prod":"TEMAKI MASSAGO","qty":18,"val":1200},{"cat":"TEMAKIS","prod":"TEMAKI SALMAO","qty":203,"val":8037},{"cat":"TEMAKIS","prod":"TEMAKI SALMAO SKIN","qty":14,"val":406},{"cat":"TEMAKIS","prod":"TEMAKI CAMARAO","qty":11,"val":538},{"cat":"TEMAKIS","prod":"TEMAKI FILADELFIA","qty":221,"val":9612},{"cat":"TEMAKIS","prod":"TEMAKI SPICY TUNA","qty":55,"val":2217},{"cat":"TEMAKIS","prod":"TEMAKI SPICY SALMAO","qty":24,"val":936},{"cat":"TEMAKIS","prod":"TEMAKI SPICY TUNA CRUNCH","qty":2,"val":60},{"cat":"TEMAKIS","prod":"TEMAKI SALMAO SKIN ESPECIAL","qty":16,"val":582},{"cat":"TEMAKIS","prod":"TEMAKI TEMPURA","qty":2,"val":116},{"cat":"TEMAKIS","prod":"TEMAKI POLVO","qty":7,"val":441},{"cat":"TEMAKIS","prod":"TEMAKI SALMAO ESPECIAL CRUNCH","qty":1,"val":59},{"cat":"TEMAKIS","prod":"TEMAKI KANI","qty":1,"val":20},{"cat":"TEMAKIS","prod":"TEMAKI SPICY SALMAO SEM ARROZ","qty":2,"val":90},{"cat":"TEMAKIS","prod":"TEMAKI SALMAO SICILIANO","qty":2,"val":54},{"cat":"TEMAKIS","prod":"TEMAKI FILADELFIA SEM ARROZ","qty":6,"val":314},{"cat":"TEMAKIS","prod":"TEMAKI ATUM SEM ARROZ","qty":4,"val":180},{"cat":"TEMAKIS","prod":"TEMAKI SALMAO SEM ARROZ","qty":15,"val":807},{"cat":"TEMAKIS","prod":"TEMAKI NAMORADO SEM ARROZ","qty":1,"val":33},{"cat":"TEMAKIS","prod":"TEMAKI SPICY TUNA SEM ARROZ","qty":2,"val":92},{"cat":"TEMAKIS","prod":"TEMAKI IKURA","qty":8,"val":784},{"cat":"TEMAKIS","prod":"TEMAKI KING CRAB","qty":24,"val":1667},{"cat":"SUGESTOES","prod":"ROBATA DE LAGOSTIN","qty":41,"val":2922},{"cat":"USSUZUKURI E TATAKI","prod":"USSUZUKURI PEIXE BRANCO PIMENTA BIQUINHO 5 UNID","qty":41,"val":1397},{"cat":"USSUZUKURI E TATAKI","prod":"USSUZUKURI DE PEIXE BRANCO 5 UNID","qty":14,"val":583},{"cat":"USSUZUKURI E TATAKI","prod":"USSUZUKURI NAMORADO 18 UNID","qty":9,"val":918},{"cat":"USSUZUKURI E TATAKI","prod":"USSUZUKURI SALMAO 18 UNID","qty":140,"val":14460},{"cat":"USSUZUKURI E TATAKI","prod":"USSUZUKURI MISTO 18 UNID","qty":18,"val":1866},{"cat":"USSUZUKURI E TATAKI","prod":"USSUZUKURI BARRIGA SALMAO 5 UNID","qty":44,"val":1860},{"cat":"USSUZUKURI E TATAKI","prod":"USSUZUKURI DE YELLOWTAIL TORO","qty":70,"val":8337},{"cat":"SAQUE","prod":"HAKUSHIKA JOSEN 1800ML","qty":9,"val":5830},{"cat":"SAQUE","prod":"HAKUSHIKA NAMACHOZO 300 ML","qty":33,"val":3331},{"cat":"SAQUE","prod":"HAKUSHIKA YAMADANISHIKI 720ML","qty":31,"val":11791},{"cat":"SAQUE","prod":"JARRA HAKUSHIKA JOSEN","qty":27,"val":4725},{"cat":"SAQUE","prod":"TC. HAKUSHIKA JOSEN","qty":472,"val":24544},{"cat":"SAQUE","prod":"MS. HAKUSHIKA JOSEN TRADIC","qty":3,"val":165},{"cat":"SAQUE","prod":"TC. SAQUE QUENTE","qty":3,"val":63},{"cat":"SAQUE","prod":"TC. YAMADANISHIKI HONJOZO","qty":109,"val":9946},{"cat":"SAQUE","prod":"HAKUSHIKA YAMADANISHIKI JUNMAI","qty":20,"val":6200},{"cat":"DOSES","prod":"DS. BLACK LABEL","qty":37,"val":1632},{"cat":"DOSES","prod":"DS. COINTREAU","qty":2,"val":50},{"cat":"DOSES","prod":"DS. GIN TANQUERAY","qty":10,"val":412},{"cat":"DOSES","prod":"DS. LICOR 43","qty":36,"val":1101},{"cat":"DOSES","prod":"DS. RED LABEL","qty":12,"val":484},{"cat":"DOSES","prod":"DS. VODKA ABSOLUT","qty":20,"val":745},{"cat":"DOSES","prod":"DS. VODKA CIROC","qty":15,"val":600},{"cat":"DOSES","prod":"SHOT CANA","qty":5,"val":156},{"cat":"DOSES","prod":"DS. LIMONCELLO","qty":6,"val":180},{"cat":"DOSES","prod":"DS WHISKY HIBIKI","qty":5,"val":506},{"cat":"DOSES","prod":"DS. BLUE LABEL","qty":23,"val":3580},{"cat":"VINHO BRANCO","prod":"AVELEDA LOUREIRO","qty":25,"val":4626},{"cat":"VINHO BRANCO","prod":"CHABLIS DOMAINE RACE","qty":47,"val":18330},{"cat":"VINHO BRANCO","prod":"CHARDONNAY ROBEMONDAVI","qty":65,"val":12530},{"cat":"VINHO BRANCO","prod":"PERA MANCA","qty":5,"val":4450},{"cat":"VINHO BRANCO","prod":"TC. PINOT GRIGIO DELLE VENEZIE","qty":2,"val":70},{"cat":"VINHO BRANCO","prod":"TC. ROBEMONDAVI CHARDONNAY","qty":239,"val":10188},{"cat":"VINHO BRANCO","prod":"BURDIZZO FRASCATI BIANCO 2020","qty":35,"val":6300},{"cat":"VINHO TINTO","prod":"TC. PINOT NOIR ROBERT MONDAVI","qty":46,"val":1956},{"cat":"VINHO TINTO","prod":"TC. SANGIOVESE","qty":75,"val":3096},{"cat":"VINHO ROSE","prod":"BARTON E GUESTIER TOURMALINE","qty":11,"val":3025},{"cat":"VINHO BRANCO","prod":"POUILLY FUME","qty":6,"val":2670},{"cat":"VINHO BRANCO","prod":"SANCERRE GITTON","qty":11,"val":4675},{"cat":"VINHO TINTO","prod":"CAPARZO SANGIOVESE","qty":23,"val":4347},{"cat":"VINHO TINTO","prod":"PINOT NOIR ROBERT MONDAVI","qty":12,"val":2340},{"cat":"ESPECIAL E CHAMPAGNE","prod":"CHANDON ROSE","qty":12,"val":2196},{"cat":"ESPECIAL E CHAMPAGNE","prod":"ESPUMANTE ADOLFO LONA BRUT","qty":6,"val":1106},{"cat":"ESPECIAL E CHAMPAGNE","prod":"LA JOLIE BLANC BRUT","qty":1,"val":176},{"cat":"ESPECIAL E CHAMPAGNE","prod":"MOET BRUT","qty":10,"val":6525},{"cat":"ESPECIAL E CHAMPAGNE","prod":"TC. ADOLFO LONA BRUT","qty":36,"val":1414},{"cat":"ESPECIAL E CHAMPAGNE","prod":"TC. CHANDON ROSE","qty":20,"val":826},{"cat":"ESPECIAL E CHAMPAGNE","prod":"TC. LA JOLIE BLANC BRUT","qty":2,"val":90},{"cat":"CAIPS E DRINKS","prod":"CAIP ABSOLUT","qty":424,"val":19245},{"cat":"CAIPS E DRINKS","prod":"CAIP CIROC","qty":15,"val":682},{"cat":"CAIPS E DRINKS","prod":"CAIP DA QUINTA","qty":248,"val":9978},{"cat":"CAIPS E DRINKS","prod":"CAIPISAQUE","qty":334,"val":13605},{"cat":"CAIPS E DRINKS","prod":"DRINK APEROL","qty":239,"val":10651},{"cat":"CAIPS E DRINKS","prod":"DRINK COSMOPOLITAN","qty":41,"val":1844},{"cat":"CAIPS E DRINKS","prod":"DRINK DRY MARTINI TANQUERAY","qty":27,"val":1235},{"cat":"CAIPS E DRINKS","prod":"DRINK FITZGERALD","qty":147,"val":6553},{"cat":"CAIPS E DRINKS","prod":"DRINK GIN TONICA TANQUERAY","qty":106,"val":4822},{"cat":"CAIPS E DRINKS","prod":"DRINK KENPAI","qty":1,"val":44},{"cat":"CAIPS E DRINKS","prod":"DRINK MOSCOW MULE - ABSOLUT","qty":71,"val":3012},{"cat":"CAIPS E DRINKS","prod":"DRINK NEGRONI","qty":98,"val":4470},{"cat":"CAIPS E DRINKS","prod":"DRINK SCOTCH SOUL","qty":12,"val":540},{"cat":"CAIPS E DRINKS","prod":"PASSION THYME","qty":118,"val":4980},{"cat":"ADICIONAIS","prod":"ADD WASABI","qty":3,"val":21},{"cat":"ADICIONAIS","prod":"PARA LEVAR 2","qty":1,"val":10},{"cat":"SOBREMESA","prod":"BOLINHO DE AMENDOAS","qty":36,"val":1263},{"cat":"SOBREMESA","prod":"DOCE LEITE","qty":165,"val":6270},{"cat":"SOBREMESA","prod":"SORVETE TAPIOCA","qty":137,"val":4426},{"cat":"SOBREMESA","prod":"FRUTA LICHIA","qty":3,"val":57},{"cat":"SOBREMESA","prod":"BALA DE COCO","qty":63,"val":378},{"cat":"SOBREMESA","prod":"HARUMAKI DE BANANA","qty":57,"val":2007},{"cat":"SOBREMESA","prod":"BRIGADEIRO DE BISCOITO MAIZENA","qty":174,"val":4922},{"cat":"SOBREMESA","prod":"BOLO DE CHOCOLATE","qty":175,"val":6888},{"cat":"SOBREMESA","prod":"MOCHI","qty":195,"val":6396},{"cat":"SOBREMESA","prod":"BOLO DE  CHOC BRANCO E MATCHA","qty":45,"val":1629},{"cat":"SOBREMESA","prod":"SORVETE DE VANILLA","qty":25,"val":625},{"cat":"SOBREMESA","prod":"TRUFAS CHOCOLATE","qty":9,"val":111},{"cat":"SOBREMESA","prod":"FRUTA ABACAXI","qty":11,"val":210},{"cat":"SOBREMESA","prod":"PANACOTA DE COCO COM CARAMELO","qty":47,"val":1554},{"cat":"CAFE E CHA","prod":"CHA HIBISCO JARRA","qty":1,"val":38},{"cat":"CAIPS E DRINKS","prod":"CAIPIVODKA SMIRNOFF","qty":2,"val":88},{"cat":"CAIPS E DRINKS","prod":"EXPRESSO MARTINI","qty":64,"val":2706},{"cat":"CAIPS E DRINKS","prod":"DRINK CARAJILLO","qty":74,"val":3347},{"cat":"SAQUE","prod":"KAZE NO MORI AKITSUHO 720ML","qty":7,"val":2583},{"cat":"SAQUE","prod":"TAIHEIZAN JUNMAI KIMOTO 720ML","qty":4,"val":1516},{"cat":"SAQUE","prod":"HAKUSHIKA JOSEN 720ML","qty":111,"val":25819},{"cat":"SAQUE","prod":"TC HAKUSHIKA JOSEN","qty":63,"val":3586},{"cat":"SAQUE","prod":"JARRA HAKUSHIKA JOSEN 500ML","qty":17,"val":3200},{"cat":"SAQUE","prod":"TC KIKUMASSAMUNE SHIBORITATE GINPACK","qty":50,"val":2424},{"cat":"SAQUE","prod":"JARRA KIKUMASSAMUNE SHIBORITATE GINPACK","qty":15,"val":2458},{"cat":"SAQUE","prod":"URAKASUMI HONJIKOMI 720ML","qty":8,"val":2193},{"cat":"SAQUE","prod":"TAISETSU ICE DOME JUNMAI GINJO 300ML","qty":5,"val":1245},{"cat":"SAQUE","prod":"URAKASUMI JUNMAI GINJO 12 720ML","qty":4,"val":1636},{"cat":"SAQUE","prod":"TAIHEIZAN JUNMAI GINJO 55 720ML","qty":11,"val":5049},{"cat":"SAQUE","prod":"KONISHI DAIGINJO 720ML - KOKUSANMAI 50% - HYOGO -","qty":2,"val":838},{"cat":"SAQUE","prod":"KONISHI DAIGINJO 720ML - KOKUSANMAI 50% - HYOGO - JAPAO","qty":8,"val":3412},{"cat":"SAQUE","prod":"AMANOTO JUNMAI DAIGINJO 45 720ML","qty":15,"val":7083},{"cat":"SAQUE","prod":"TACA HAKUSHIKA HANA-HOKAKU JUNMAI DAIGINJO UMESHU","qty":10,"val":360},{"cat":"SAQUE","prod":"REGUA SAKE","qty":12,"val":1828},{"cat":"CAIPS E DRINKS","prod":"YUZU BREEZE","qty":92,"val":4372},{"cat":"SOBREMESA","prod":"DOCE DE LEITE C SORVETE DE QUEIJO","qty":20,"val":802},{"cat":"CAIPS E DRINKS","prod":"SHOT DE TEQUILA","qty":8,"val":224},{"cat":"CAIPS E DRINKS","prod":"DRINK MARGUERITA","qty":30,"val":1566},{"cat":"COZINHA CLASSICOS","prod":"YAKISSOBA EBI","qty":14,"val":1246},{"cat":"VINHO BRANCO","prod":"PINOT GRIGIO TORRESELLA","qty":73,"val":14220},{"cat":"VINHO BRANCO","prod":"TC. PINOT GRIGIO TORESSELA","qty":238,"val":10076},{"cat":"ENTRADA QUENTE","prod":"KIMCHI ARTESANAL","qty":7,"val":113},{"cat":"SUGESTOES","prod":"ARROZ FRITO DE KIMCHI","qty":30,"val":2666},{"cat":"ENTRADA QUENTE","prod":"WONTON DE QUEIJO","qty":3,"val":84},{"cat":"COZINHA ESPECIAIS","prod":"MISSO BLACK COD MUSSELINE DE BATATA C WASABI","qty":78,"val":11118},{"cat":"CAIPS E DRINKS","prod":"DRINK HANAMI","qty":53,"val":2256},{"cat":"CAIPS E DRINKS","prod":"IZAKAYA COCKTAIL","qty":68,"val":2860},{"cat":"CAIPS E DRINKS","prod":"NEVE DE HOKKAIDO","qty":26,"val":1413},{"cat":"CAIPS E DRINKS","prod":"AKAI SHIMA","qty":60,"val":2715},{"cat":"CAIPS E DRINKS","prod":"MARGARITA","qty":6,"val":312},{"cat":"CAIPS E DRINKS","prod":"OLD FASHIONED","qty":12,"val":596},{"cat":"CAIPS E DRINKS","prod":"MOJITO","qty":16,"val":677},{"cat":"CAIPS E DRINKS","prod":"DRINK PENICILLIN","qty":29,"val":1329},{"cat":"CAIPS E DRINKS","prod":"DRINK CARDINALE","qty":1,"val":48},{"cat":"VINHO BRANCO","prod":"VINA ESMERALDA BLANCO","qty":25,"val":4566},{"cat":"VINHO BRANCO","prod":"TC VINA ESMERALDA BLANCO","qty":55,"val":2216},{"cat":"SUGESTOES","prod":"BAO FISH","qty":39,"val":1365},{"cat":"COZINHA ESPECIAIS","prod":"PRATO INFANTIL MIGNON","qty":8,"val":392},{"cat":"COZINHA ESPECIAIS","prod":"PRATO INFANTIL FRANGO","qty":3,"val":120},{"cat":"SUGESTOES","prod":"PAD THAI DE CAMARAO","qty":31,"val":3421},{"cat":"SUGESTOES","prod":"PAD THAI DE COGUMELOS","qty":5,"val":418},{"cat":"SUGESTOES","prod":"TONKATSU","qty":4,"val":216},{"cat":"SOBREMESA","prod":"BOLO DE AMENDOAS C CALDA DE CHOCOLATE BRANCO","qty":17,"val":544},{"cat":"ESPECIAL E CHAMPAGNE","prod":"BEVITTO BRUT","qty":6,"val":1134},{"cat":"ESPECIAL E CHAMPAGNE","prod":"TC. BEVITTO BRUT","qty":18,"val":756},{"cat":"VINHO BRANCO","prod":"COTES DE PROVENCE","qty":24,"val":4626},{"cat":"VINHO BRANCO","prod":"TC COTES DE PROVENCE","qty":44,"val":1878},{"cat":"SUGESTOES","prod":"SIO MAI CAMARO E CURRY VERDE","qty":14,"val":714},{"cat":"IF BEBIDAS NAO ALCOOLICAS","prod":"IF. AGUA COM GAS","qty":2,"val":20},{"cat":"IF BEBIDAS NAO ALCOOLICAS","prod":"IF. AGUA SEM GAS","qty":4,"val":40},{"cat":"IF BEBIDAS NAO ALCOOLICAS","prod":"IF. COCA COLA COMUM","qty":15,"val":183},{"cat":"IF BEBIDAS NAO ALCOOLICAS","prod":"IF. COCA COLA ZERO","qty":71,"val":873},{"cat":"IF BEBIDAS NAO ALCOOLICAS","prod":"IF. GUARANA COMUM","qty":6,"val":72},{"cat":"IF BEBIDAS NAO ALCOOLICAS","prod":"IF. GUARANA ZERO","qty":26,"val":312},{"cat":"IF COZINHA CLASSICOS","prod":"IF. TEMPURA DE LEGUMES","qty":6,"val":537},{"cat":"IF ACOMPANHAMENTO","prod":"IF. AC. YAKIMESHI SHITAKE","qty":13,"val":533},{"cat":"IF ACOMPANHAMENTO","prod":"IF. AC. GOHAN","qty":53,"val":1104},{"cat":"IF ACOMPANHAMENTO","prod":"IF. AC. YAKIMESHI SHIMEJI","qty":20,"val":847},{"cat":"IF ACOMPANHAMENTO","prod":"IF. EXTRA DE GARI","qty":64,"val":522},{"cat":"IF ACOMPANHAMENTO","prod":"IF. EXTRA WASABI","qty":41,"val":331},{"cat":"IF ENTRADA FRIA","prod":"IF. CARPACCIO DE POLVO QUENTE","qty":3,"val":255},{"cat":"IF ENTRADA FRIA","prod":"IF. SUNOMONO","qty":65,"val":2314},{"cat":"IF ENTRADA FRIA","prod":"IF. TARTAR DE ATUM CAIPIRA","qty":101,"val":8140},{"cat":"IF ENTRADA FRIA","prod":"IF. ATUM VERMELHO PICANTE","qty":51,"val":3880},{"cat":"IF ENTRADA FRIA","prod":"IF. SALADA ATUM COM NORI CROCANTE","qty":6,"val":518},{"cat":"IF ENTRADA FRIA","prod":"IF. SALMAO EM CUBOS","qty":40,"val":3245},{"cat":"IF ENTRADA FRIA","prod":"IF. POLVO SL","qty":13,"val":1703},{"cat":"IF ENTRADA FRIA","prod":"IF. MINI TACO","qty":43,"val":1998},{"cat":"IF ENTRADA FRIA","prod":"IF. ATUM SELADO","qty":5,"val":225},{"cat":"IF ENTRADA FRIA","prod":"IF. SALMAO MARINADO BALSAMICO","qty":31,"val":1458},{"cat":"IF ENTRADA FRIA","prod":"IF. CARPACCIO DO FRANCA","qty":105,"val":9612},{"cat":"IF ENTRADA FRIA","prod":"IF. MISSOSHIRO","qty":86,"val":3018},{"cat":"IF ENTRADA FRIA","prod":"IF. HARUMAKI DE CAMARAO","qty":132,"val":7117},{"cat":"IF ENTRADA FRIA","prod":"IF. GUIOZA SUINA","qty":78,"val":3306},{"cat":"IF ENTRADA FRIA","prod":"IF. CHIPS BATATA DOCE SPICY","qty":24,"val":852},{"cat":"IF ENTRADA QUENTE","prod":"IF. NIRA","qty":99,"val":5031},{"cat":"IF ENTRADA FRIA","prod":"IF. STICKY SALMAO ROLL","qty":27,"val":1449},{"cat":"IF ENTRADA QUENTE","prod":"IF. CAMARAO POPS","qty":38,"val":3024},{"cat":"IF ENTRADA FRIA","prod":"IF. SHIMEJI OU SHITAKE","qty":35,"val":2433.2},{"cat":"IF ENTRADA FRIA","prod":"IF. EDAMAME","qty":102,"val":4237},{"cat":"IF ENTRADA FRIA","prod":"IF. GUIOZA VEGETARIANA","qty":58,"val":2514},{"cat":"IF ENTRADA FRIA","prod":"IF. TEMPURA DE MILHO","qty":34,"val":1414},{"cat":"IF ENTRADA FRIA","prod":"IF. SALMAO SELADO","qty":2,"val":90},{"cat":"IF COMBINADO","prod":"IF. COMBINADO TUNA SAL","qty":44,"val":15113},{"cat":"IF COMBINADO","prod":"IF. COMBINADO SELECAO 26 PECAS - SUSHI BAR","qty":21,"val":6348},{"cat":"IF COMBINADO","prod":"IF. COMBINADO BASICO 41 PECAS - DOIS BASICO","qty":53,"val":15144},{"cat":"IF COMBINADO","prod":"IF. COMBINADO SUSHI 13 PECAS - SUSHI DIVERSOS","qty":28,"val":4172},{"cat":"IF COMBINADO","prod":"IF. COMBINADO SASHIMI 28 PECAS - DIVERSOS","qty":9,"val":2106},{"cat":"IF COMBINADO","prod":"IF. COMBINADO SALMAO 15 PECAS","qty":272,"val":34558},{"cat":"IF COMBINADO","prod":"IF. COMBINADO 19 PECAS + ACOMP","qty":7,"val":1179},{"cat":"IF COMBINADO","prod":"IF. COMBINADO 16 PECAS + ACOMP","qty":13,"val":1465},{"cat":"IF COMBINADO","prod":"IF. COMBINADO 28 PECAS","qty":13,"val":2626},{"cat":"IF COZINHA CLASSICOS","prod":"IF. FURAI FRANGO","qty":12,"val":720},{"cat":"IF COZINHA CLASSICOS","prod":"IF. TEMPURA CAMARAO","qty":4,"val":1048},{"cat":"IF COZINHA CLASSICOS","prod":"IF. YAKISSOBA LEGUMES","qty":26,"val":1696},{"cat":"IF COZINHA CLASSICOS","prod":"IF. YAKISSOBA MIGNON","qty":114,"val":9026},{"cat":"IF COZINHA ESPECIAIS","prod":"IF. TEPPAN YAKI DE MIGNON","qty":9,"val":899},{"cat":"IF COZINHA ESPECIAIS","prod":"IF. TEPPAN YAKI DE SALMAO","qty":26,"val":2548},{"cat":"IF MAKI","prod":"IF. MAKI SALMAO LIGHT","qty":40,"val":2196},{"cat":"IF MAKI","prod":"IF. SALMAO MAKI","qty":101,"val":2873},{"cat":"IF MAKI","prod":"IF. KAPPA MAKI","qty":28,"val":733},{"cat":"IF MAKI","prod":"IF. FILADELFIA ESPECIAL","qty":55,"val":3240},{"cat":"IF MAKI","prod":"IF. SPICY TUNA MAKI","qty":32,"val":1126},{"cat":"IF MAKI","prod":"IF. SPICY SALMAO MAKI","qty":4,"val":143},{"cat":"IF MAKI","prod":"IF. SALMAO SKIN ESPECIAL","qty":11,"val":433},{"cat":"IF MAKI","prod":"IF. SPICY TUNA AVOCADO","qty":37,"val":2118},{"cat":"IF MAKI","prod":"IF. CALIFORNIA","qty":34,"val":917},{"cat":"IF MAKI","prod":"IF. HOT MAKI","qty":99,"val":8389},{"cat":"IF MAKI","prod":"IF. FILADELFIA","qty":356,"val":19987},{"cat":"IF MAKI","prod":"IF. ASPARGO SALMAO ROLL","qty":28,"val":1654},{"cat":"IF MAKI","prod":"IF. HOT QUINOA","qty":100,"val":5712},{"cat":"IF MAKI","prod":"IF. SPICY CAMARAO","qty":59,"val":4919},{"cat":"IF MAKI","prod":"IF. TEKKA MAKI","qty":59,"val":1706},{"cat":"IF MAKI","prod":"IF. MAKI VEGGIE","qty":6,"val":248},{"cat":"IF MAKI","prod":"IF. SPICY SALMAO AVOCADO","qty":54,"val":3084},{"cat":"IF SASHIMI TRADICIONAL","prod":"IF. SASHIMI ATUM","qty":67,"val":3030},{"cat":"IF SASHIMI TRADICIONAL","prod":"IF SASHIMI SALMAO","qty":301,"val":12310},{"cat":"IF SASHIMI TRADICIONAL","prod":"IF. SASHIMI NAMORADO","qty":14,"val":645},{"cat":"IF SASHIMI TRADICIONAL","prod":"IF. SASHIMI POLVO","qty":12,"val":936},{"cat":"IF SASHIMI TRADICIONAL","prod":"IF. MIX DE SASHIMI","qty":47,"val":5606},{"cat":"IF SASHIMI TRADICIONAL","prod":"IF. SASHIMI VIEIRA","qty":27,"val":2541},{"cat":"IF SASHIMI TRADICIONAL","prod":"IF. SASHIMI AGULHAO BRANCO","qty":11,"val":495},{"cat":"IF SASHIMI TRADICIONAL","prod":"IF. SASHIMI SALMAO GRAVLAX","qty":26,"val":1514},{"cat":"IF SASHIMI TRADICIONAL","prod":"IF. SASHIMI POLVO TRUFADO","qty":7,"val":546},{"cat":"IF SASHIMI ESPECIAL","prod":"IF. SASHIMI SALMAO QUINOA CROCANTE","qty":254,"val":13716},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI ATUM","qty":111,"val":3138},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI SALMAO","qty":190,"val":5386},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI NAMORADO","qty":25,"val":720},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI CAMARAO","qty":51,"val":1794},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI POLVO","qty":18,"val":630},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI AGULHAO BRANCO","qty":113,"val":3361},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI SALMAO ESPECIAL CRUNCH","qty":38,"val":1270},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI SALMAO SKIN","qty":60,"val":1360},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI VIEIRA","qty":86,"val":5608},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI SHIMEJI","qty":3,"val":78},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI SPICY TUNA CRUNCH","qty":18,"val":576},{"cat":"ENTRADA QUENTE","prod":"BERINJELA NO MISSO","qty":26,"val":988},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI SALMAO GRAVLAX","qty":47,"val":1498},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI SALMAO SICILIANO","qty":62,"val":2081},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI OVO DE CODORNA","qty":202,"val":6279},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI ATUM TRUF MASSARICADO","qty":39,"val":1239},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI SALMAO TRUF MASSARICADO","qty":281,"val":8664},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI VIEIRA C SALMAO","qty":74,"val":3678},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI SALMAO QUINOA CROCANTE","qty":188,"val":5920},{"cat":"IF SUSHI TRADICIONAL","prod":"IF. DUPLA SUSHI SALMAO MACARICADO","qty":2,"val":60},{"cat":"IF USSUZUKURI","prod":"IF. USSUZUKURI DE PEIXE BRANCO 5 UNID","qty":10,"val":458},{"cat":"IF USSUZUKURI","prod":"IF. USSUZUKURI 18 UNID","qty":24,"val":2733},{"cat":"IF USSUZUKURI","prod":"IF. USSUZUKURI BARRIGA SALMAO 5 UNID","qty":25,"val":1239},{"cat":"IF ADICIONAIS","prod":"IF. EXTRA DE GERGELIM","qty":10,"val":44},{"cat":"IF ACOMPANHAMENTO","prod":"IF. EXTRA DE AZEITE TRUFADO","qty":42,"val":296},{"cat":"IF ACOMPANHAMENTO","prod":"IF. ADD MOLHO TERIYAKI","qty":47,"val":333},{"cat":"IF SOBREMESA","prod":"IF. TRUFAS","qty":14,"val":252},{"cat":"IF SOBREMESA","prod":"IF. BALA DE COCO","qty":66,"val":660},{"cat":"IF SOBREMESA","prod":"IF. BOLO DE CHOCOLATE","qty":17,"val":706},{"cat":"IF MAKI","prod":"IF. BATERA DE SALMAO OU ATUM","qty":57,"val":3180},{"cat":"IF ENTRADA FRIA","prod":"IF. TARTAR DE SALMAO OU ATUM","qty":45,"val":3257.57},{"cat":"IF ADICIONAIS","prod":"ESCOLHA A QUANTIDADE DE KITS","qty":132,"val":1.32},{"cat":"IF SOBREMESA","prod":"IF. BOLO CHOC BRANCO E MATCHA","qty":2,"val":70},{"cat":"IF SAQUE","prod":"IF. HAKUSHIKA JOSEN 720ML","qty":3,"val":810},{"cat":"RP ENTRADA QUENTE","prod":"RP. HARUMAKI DE CAMARAO","qty":3,"val":159},{"cat":"RP ENTRADA QUENTE","prod":"RP. GUIOZA VEGETARIANA","qty":1,"val":43},{"cat":"RP COMBINADO","prod":"RP. COMBINADO SASHIMI 28 PECAS - DIVERSOS","qty":1,"val":234},{"cat":"RP COZINHA CLASSICOS","prod":"RP. YAKISSOBA MIGNON","qty":1,"val":71},{"cat":"RP USSUZUKURI","prod":"RP. USSUZUKURI NAMORADO 18 UNID","qty":1,"val":113},{"cat":"RP ADICIONAIS","prod":"RP. TAXA 7.99","qty":1,"val":7.99},{"cat":"ST BEBIDAS NAO ALCOOLICAS","prod":"ST. AGUA SEM GAS","qty":1,"val":10},{"cat":"ST BEBIDAS NAO ALCOOLICAS","prod":"ST. COCA COLA COMUM","qty":2,"val":22},{"cat":"ST BEBIDAS NAO ALCOOLICAS","prod":"ST. COCA COLA ZERO","qty":11,"val":121},{"cat":"ST BEBIDAS NAO ALCOOLICAS","prod":"ST. GUARANA COMUM","qty":3,"val":33},{"cat":"ST ACOMPANHAMENTO","prod":"ST. AC. YAKIMESHI DE LEGUMES","qty":5,"val":185},{"cat":"ST ACOMPANHAMENTO","prod":"ST. AC. YAKIMESHI SHITAKE","qty":1,"val":39},{"cat":"ST ACOMPANHAMENTO","prod":"ST. AC. GOHAN","qty":9,"val":153},{"cat":"ST ENTRADA FRIA","prod":"ST. TARTAR DE SALMAO","qty":11,"val":748},{"cat":"ST ENTRADA FRIA","prod":"ST. SUNOMONO","qty":11,"val":407},{"cat":"ST ENTRADA FRIA","prod":"ST. TARTAR DE ATUM","qty":3,"val":204},{"cat":"ST ENTRADA FRIA","prod":"ST. TARTAR DE ATUM CAIPIRA","qty":29,"val":2175},{"cat":"ST ENTRADA FRIA","prod":"ST. ATUM VERMELHO PICANTE","qty":6,"val":390},{"cat":"ST ENTRADA FRIA","prod":"ST. SALADA ATUM COM NORI CROCANTE","qty":3,"val":243},{"cat":"ST ENTRADA FRIA","prod":"ST. SALMAO EM CUBOS","qty":15,"val":1125},{"cat":"ST ENTRADA FRIA","prod":"ST. POLVO SL","qty":1,"val":109},{"cat":"ST ENTRADA FRIA","prod":"ST. CARPACCIO SALMAO FRANCA","qty":40,"val":3320},{"cat":"ST ENTRADA FRIA","prod":"ST. TATAKI ATUM","qty":5,"val":280},{"cat":"ST ENTRADA FRIA","prod":"ST. MINI TACO","qty":6,"val":252},{"cat":"ST ENTRADA FRIA","prod":"ST. SALMAO MARINADO BALSAMICO","qty":6,"val":270},{"cat":"ST ENTRADA QUENTE","prod":"ST. MISSOSHIRO","qty":17,"val":561},{"cat":"ST ENTRADA QUENTE","prod":"ST. SHIMEJI","qty":4,"val":248},{"cat":"ST ENTRADA QUENTE","prod":"ST. SHITAKE","qty":1,"val":62},{"cat":"ST ENTRADA QUENTE","prod":"ST. HARUMAKI DE CAMARAO","qty":32,"val":1600},{"cat":"ST ENTRADA QUENTE","prod":"ST. GUIOZA SUINA","qty":11,"val":440},{"cat":"ST ENTRADA QUENTE","prod":"ST. CHIPS BATATA DOCE SPICY","qty":10,"val":330},{"cat":"ST ENTRADA QUENTE","prod":"ST. NIRA","qty":11,"val":517},{"cat":"ST ENTRADA QUENTE","prod":"ST. ATUM SELADO PONZU E GEMA DE OVO","qty":1,"val":45},{"cat":"ST ENTRADA QUENTE","prod":"ST. STICKY SALMAO ROLL","qty":2,"val":100},{"cat":"ST ENTRADA QUENTE","prod":"ST. SPICY TUNA NO SHISO","qty":7,"val":357},{"cat":"ST ENTRADA QUENTE","prod":"ST. CAMARAO POPS","qty":5,"val":360},{"cat":"ST ENTRADA QUENTE","prod":"ST. EDAMAME","qty":34,"val":1326},{"cat":"ST ENTRADA QUENTE","prod":"ST. GUIOZA VEGETARIANA","qty":14,"val":560},{"cat":"ST ENTRADA QUENTE","prod":"ST. TEMPURA DE MILHO","qty":9,"val":279},{"cat":"ST COMBINADO","prod":"ST. COMBINADO TUNA SAL","qty":15,"val":4200},{"cat":"ST COMBINADO","prod":"ST. COMBINADO SELECAO 26 PECAS - SUSHI BAR","qty":4,"val":996},{"cat":"ST COMBINADO","prod":"ST. COMBINADO BASICO 41 PECAS - DOIS BASICO","qty":5,"val":1265},{"cat":"ST COMBINADO","prod":"ST. COMBINADO SUSHI 13 PECAS - SUSHI DIVERSOS","qty":5,"val":710},{"cat":"ST COMBINADO","prod":"ST. COMBINADO SASHIMI 28 PECAS - DIVERSOS","qty":3,"val":660},{"cat":"ST COMBINADO","prod":"ST. COMBINADO 16 PECAS + EDAMAME","qty":3,"val":321},{"cat":"ST COMBINADO","prod":"ST. COMBINADO 16 PECAS + MISSOSHIRO","qty":1,"val":107},{"cat":"ST COMBINADO","prod":"ST. COMBINADO 19 PECAS + ACOMPANHAMENTO","qty":3,"val":459},{"cat":"ST COMBINADO","prod":"ST. COMBINADO SALMAO 15 PECAS","qty":43,"val":4300},{"cat":"ST COMBINADO","prod":"ST. COMBINADO 28 PECAS - DIVERSOS","qty":2,"val":398},{"cat":"ST COZINHA CLASSICOS","prod":"ST. FURAI FRANGO","qty":4,"val":228},{"cat":"ST COZINHA CLASSICOS","prod":"ST. TEMPURA CAMARAO","qty":2,"val":492},{"cat":"ST COZINHA CLASSICOS","prod":"ST. TEPPAN YAKI DE MIGNON","qty":3,"val":276},{"cat":"ST COZINHA CLASSICOS","prod":"ST. TEPPAN YAKI DE SALMAO","qty":5,"val":460},{"cat":"ST COZINHA CLASSICOS","prod":"ST. YAKISSOBA LEGUMES","qty":5,"val":295},{"cat":"ST COZINHA CLASSICOS","prod":"ST. YAKISSOBA MIGNON","qty":24,"val":1752},{"cat":"ST COZINHA CLASSICOS","prod":"ST. YAKISSOBA FRANGO","qty":2,"val":138},{"cat":"ST COZINHA ESPECIAIS","prod":"ST. SALMAO FOIE MARINADO NO MISSO","qty":2,"val":220},{"cat":"ST COZINHA ESPECIAIS","prod":"ST. TEMPURA DE LEGUMES","qty":1,"val":77},{"cat":"ST COZINHA ESPECIAIS","prod":"ST. ATUM SEMI GRELHADO COM FOIE","qty":2,"val":298},{"cat":"ST EXECUTIVO","prod":"ST. EXECUTIVO POKE TIRASHI","qty":17,"val":1274.32},{"cat":"ST EXECUTIVO","prod":"ST. EXECUTIVO COMBINADO 14 PECAS SUSHI MAKI","qty":5,"val":355},{"cat":"ST EXECUTIVO","prod":"ST. EXECUTIVO SL","qty":1,"val":99},{"cat":"ST EXECUTIVO","prod":"ST. EXECUTIVO COMBINADO HOT 20 PECAS","qty":5,"val":555},{"cat":"ST EXECUTIVO","prod":"ST. AD. PEPINO SUNOMONO POKE TIRASHI","qty":1,"val":8},{"cat":"ST EXECUTIVO","prod":"ST. AD. TEMPURA DE MILHO POKE TIRASHI","qty":3,"val":24},{"cat":"ST EXECUTIVO","prod":"ST. AD. ABACATE EM CUBOS POKE TIRASHI","qty":1,"val":8},{"cat":"ST EXECUTIVO","prod":"ST. AD. SALMAO EM CUBOS POKE TIRASHI","qty":2,"val":50},{"cat":"ST MAKI","prod":"ST. SALMAO MAKI","qty":29,"val":754},{"cat":"ST MAKI","prod":"ST. SALMAO SKIN MAKI","qty":2,"val":64},{"cat":"ST MAKI","prod":"ST. FILADELFIA ESPECIAL","qty":30,"val":1650},{"cat":"ST MAKI","prod":"ST. SPICY TUNA MAKI","qty":7,"val":231},{"cat":"ST MAKI","prod":"ST. SPICY SALMAO MAKI","qty":1,"val":33},{"cat":"ST MAKI","prod":"ST. SALMAO SKIN ESPECIAL","qty":2,"val":70},{"cat":"ST MAKI","prod":"ST. SPICY TUNA AVOCADO","qty":6,"val":330},{"cat":"ST MAKI","prod":"ST. CALIFORNIA","qty":14,"val":336},{"cat":"ST MAKI","prod":"ST. HOT MAKI","qty":41,"val":3157},{"cat":"ST MAKI","prod":"ST. FILADELFIA","qty":88,"val":4664},{"cat":"ST MAKI","prod":"ST. ASPARGO SALMAO ROLL","qty":4,"val":224},{"cat":"ST MAKI","prod":"ST. HOT QUINOA","qty":12,"val":648},{"cat":"ST MAKI","prod":"ST. SPICY CAMARAO","qty":16,"val":1168},{"cat":"ST MAKI","prod":"ST. TEKKA MAKI","qty":11,"val":286},{"cat":"ST MAKI","prod":"ST. SPICY TUNA AVOCADO CRISP","qty":4,"val":168},{"cat":"ST MAKI","prod":"ST. BATERA BLACK COD","qty":8,"val":440},{"cat":"ST MAKI","prod":"ST. BATERA DE SALMAO","qty":15,"val":780},{"cat":"ST MAKI","prod":"ST. BARRIGA ROLL","qty":19,"val":1140},{"cat":"ST MAKI","prod":"ST. BATERA DE ATUM","qty":3,"val":156},{"cat":"ST MAKI","prod":"ST. SPICY SALMAO AVOCADO","qty":3,"val":165},{"cat":"ST ROBATA","prod":"ST. ROBATA DE MIGNON","qty":2,"val":90},{"cat":"ST SUGESTOES","prod":"ST. LULA RECHEADA","qty":1,"val":95},{"cat":"ST SUGESTOES","prod":"ST. DUPLA SUSHI DE HADDOCK DEFUMADO","qty":2,"val":48},{"cat":"ST SASHIMI TRADICIONAL","prod":"ST. SASHIMI ATUM","qty":9,"val":387},{"cat":"ST SASHIMI TRADICIONAL","prod":"ST. SASHIMI SALMAO","qty":70,"val":3010},{"cat":"ST SASHIMI TRADICIONAL","prod":"ST. SASHIMI NAMORADO","qty":2,"val":84},{"cat":"ST SASHIMI TRADICIONAL","prod":"ST. SASHIMI HADDOCK","qty":1,"val":73},{"cat":"ST SASHIMI TRADICIONAL","prod":"ST. SASHIMI POLVO","qty":8,"val":576},{"cat":"ST SASHIMI TRADICIONAL","prod":"ST. MIX DE SASHIMI","qty":14,"val":1526},{"cat":"ST SASHIMI TRADICIONAL","prod":"ST. SASHIMI VIEIRA","qty":1,"val":89},{"cat":"ST SASHIMI ESPECIAL","prod":"ST. SASHIMI SALMAO GRAVLAX","qty":7,"val":378},{"cat":"ST SASHIMI ESPECIAL","prod":"ST. SASHIMI SALMAO QUINOA CROCANTE","qty":57,"val":2907},{"cat":"ST SASHIMI ESPECIAL","prod":"ST. SASHIMI SALMAO SELADO","qty":12,"val":456},{"cat":"ST SUSHI TRADICIONAL","prod":"ST. DUPLA BARRIGA SALMAO","qty":1,"val":27},{"cat":"ST SUSHI TRADICIONAL","prod":"ST. DUPLA SUSHI ATUM","qty":16,"val":432},{"cat":"ST SUSHI TRADICIONAL","prod":"ST. DUPLA SUSHI SALMAO","qty":64,"val":1728},{"cat":"ST SUSHI TRADICIONAL","prod":"ST. DUPLA SUSHI BURI OLHO DE BOI","qty":2,"val":38},{"cat":"ST SUSHI TRADICIONAL","prod":"ST. DUPLA SUSHI NAMORADO","qty":5,"val":135},{"cat":"ST SUSHI TRADICIONAL","prod":"ST. DUPLA SUSHI CAMARAO","qty":3,"val":99},{"cat":"ST SUSHI TRADICIONAL","prod":"ST. DUPLA SUSHI IKURA","qty":3,"val":207},{"cat":"ST SUSHI TRADICIONAL","prod":"ST. DUPLA SUSHI AGULHAO BRANCO","qty":20,"val":560},{"cat":"ST SUSHI TRADICIONAL","prod":"ST. DUPLA SUSHI SALMAO ESPECIAL CRUNCH","qty":29,"val":870},{"cat":"ST SUSHI TRADICIONAL","prod":"ST. DUPLA SUSHI SALMAO SKIN","qty":1,"val":18},{"cat":"ST SUSHI TRADICIONAL","prod":"ST. DUPLA SUSHI VIEIRA","qty":22,"val":1364},{"cat":"ST SUSHI ESPECIAL","prod":"ST. DUPLA SUSHI SALMAO GRAVLAX","qty":20,"val":560},{"cat":"ST SUSHI ESPECIAL","prod":"ST. DUPLA SUSHI MAGURO TAMAGO","qty":7,"val":259},{"cat":"ST SUSHI ESPECIAL","prod":"ST. DUPLA SUSHI SALMAO SKIN ESPECIAL","qty":3,"val":75},{"cat":"ST SUSHI ESPECIAL","prod":"ST. DUPLA SUSHI SALMAO SICILIANO","qty":46,"val":1426},{"cat":"ST SUSHI ESPECIAL","prod":"ST. DUPLA SUSHI MAGURO ZUKE","qty":5,"val":135},{"cat":"ST SUSHI ESPECIAL","prod":"ST. DUPLA SUSHI VIEIRA COM LICHIA","qty":5,"val":335},{"cat":"ST SUSHI ESPECIAL","prod":"ST. DUPLA SUSHI OVO DE CODORNA","qty":65,"val":1885},{"cat":"ST SUSHI ESPECIAL","prod":"ST. D. CRISPY RICE ATUM","qty":3,"val":87},{"cat":"ST SUSHI ESPECIAL","prod":"ST. DUPLA SUSHI SALMAO TRUF MASSARICADO","qty":4,"val":116},{"cat":"ST SUSHI ESPECIAL","prod":"ST. DUPLA SUSHI BARRIGA SALMAO FOIE GRAS","qty":22,"val":1034},{"cat":"ST SUSHI ESPECIAL","prod":"ST. DUPLA SUSHI VIEIRA C SALMAO","qty":21,"val":966},{"cat":"ST SUSHI ESPECIAL","prod":"ST. DUPLA SUSHI SALMAO QUINOA CROCANTE","qty":95,"val":2660},{"cat":"ST SUSHI ESPECIAL","prod":"ST. DUPLA SUSHI VIEIRA GRELHADA COM GUACAMOLE DE P","qty":3,"val":201},{"cat":"ST SUSHI ESPECIAL","prod":"ST. DUPLA SUSHI AGULHAO TRUFADO","qty":2,"val":60},{"cat":"ST SUSHI ESPECIAL","prod":"ST. D CRISPY RICE SALMAO","qty":7,"val":203},{"cat":"ST USSUZUKURI","prod":"ST. USSUZUKURI NAMORADO PIMENTA BIQUINHO 5 UNID","qty":3,"val":129},{"cat":"ST USSUZUKURI","prod":"ST. USSUZUKURI DE PEIXE BRANCO 5 UNID","qty":1,"val":31},{"cat":"ST USSUZUKURI","prod":"ST. USSUZUKURI NAMORADO 18 UNID","qty":1,"val":111},{"cat":"ST USSUZUKURI","prod":"ST. USSUZUKURI SALMAO 18 UNID","qty":4,"val":444},{"cat":"ST USSUZUKURI","prod":"ST. USSUZUKURI BARRIGA SALMAO 5 UNID","qty":12,"val":540},{"cat":"ST ADICIONAIS","prod":"ST. ADD MIX DE GERGELIM","qty":1,"val":4},{"cat":"ST ADICIONAIS","prod":"ST. EXTRA WASABI","qty":3,"val":12},{"cat":"ST ADICIONAIS","prod":"ST. EXTRA GARI","qty":10,"val":80},{"cat":"ST ADICIONAIS","prod":"ST. TAXA DE ENTREGA SUSHI","qty":5,"val":49.5},{"cat":"ST ADICIONAIS","prod":"ST. PARA LEVAR 2","qty":20,"val":200},{"cat":"ST ADICIONAIS","prod":"ST. TAXA 7.99","qty":87,"val":695.13},{"cat":"ST ADICIONAIS","prod":"ST. TAXA 8.99","qty":20,"val":179.8},{"cat":"ST ADICIONAIS","prod":"ST. TAXA 10.99","qty":34,"val":373.66},{"cat":"ST ADICIONAIS","prod":"ST. TAXA 9.99","qty":31,"val":309.69},{"cat":"ST ADICIONAIS","prod":"ST. ADD AZEITE TRUFADO","qty":11,"val":77},{"cat":"ST ADICIONAIS","prod":"ST. ADD MOLHO TERIYAKI","qty":8,"val":40},{"cat":"ST SOBREMESA","prod":"ST. BALA DE COCO","qty":8,"val":72},{"cat":"ST SOBREMESA","prod":"ST. HARUMAKI DE BANANA","qty":7,"val":245},{"cat":"ST SOBREMESA","prod":"ST. BRIGADEIRO DE BISCOITO MAIZENA","qty":14,"val":406},{"cat":"ST SOBREMESA","prod":"ST. BOLO DE CHOCOLATE","qty":10,"val":390},{"cat":"ST SOBREMESA","prod":"ST. DOCE DE LEITE C SORVETE DE QUEIJO","qty":1,"val":38},{"cat":"EXECUTIVO","prod":"EX. GOHAN SALADA E TONKATSU","qty":3,"val":188.97},{"cat":"EXECUTIVO","prod":"EX. GOHAN SALADA E NAMORADO","qty":2,"val":183.98},{"cat":"EXECUTIVO","prod":"EX. GOHAN SALADA E MIGNON","qty":3,"val":227.97},{"cat":"EXECUTIVO","prod":"EX. GOHAN SALADA E FRANGO","qty":2,"val":125.98},{"cat":"SUGESTOES","prod":"PAD THAI DE FRANGO","qty":10,"val":620},{"cat":"SUGESTOES","prod":"PAD THAI DE MIGNON","qty":8,"val":656}];window.__BI_COMPRAS__   = [];window.__BI_COMISSOES__ = [];</script>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BI  Hub</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Mono:wght@300;400;500&family=Crimson+Pro:ital,wght@0,300;0,400;0,600;1,300&display=swap" rel="stylesheet">
<style>
:root {
  --bg:       #09090a;
  --s1:       #111113;
  --s2:       #18181b;
  --s3:       #222226;
  --border:   #2c2c32;
  --gold:     #d4a843;
  --gold2:    #f0c060;
  --gold-dim: #6b5220;
  --green:    #4d9e6e;
  --blue:     #4a7fa0;
  --rose:     #b05a4a;
  --violet:   #7a5ab8;
  --teal:     #3a8a8a;
  --text:     #e4e0d4;
  --muted:    #6b6b60;
  --muted2:   #4a4a42;
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }
body {
  background: var(--bg);
  color: var(--text);
  font-family: 'DM Mono', monospace;
  font-size: 12px;
  min-height: 100vh;
  overflow-x: hidden;
}

/*  SETUP SCREEN  */
#setup-screen {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 24px;
  position: relative;
  overflow: hidden;
}
#setup-screen::before {
  content: '';
  position: absolute; inset: 0;
  background:
    radial-gradient(ellipse 80% 50% at 50% 0%, #1a1000 0%, transparent 70%),
    radial-gradient(ellipse 40% 40% at 90% 90%, #0a1020 0%, transparent 60%);
  pointer-events: none;
}
.setup-grid-bg {
  position: absolute; inset: 0;
  background-image:
    linear-gradient(var(--border) 1px, transparent 1px),
    linear-gradient(90deg, var(--border) 1px, transparent 1px);
  background-size: 40px 40px;
  opacity: 0.18;
  pointer-events: none;
}
.setup-inner {
  position: relative;
  width: 100%;
  max-width: 860px;
  display: flex;
  flex-direction: column;
  gap: 28px;
  align-items: center;
}
.setup-logo {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 4rem;
  letter-spacing: 0.1em;
  color: var(--gold);
  line-height: 1;
  text-align: center;
}
.setup-logo span {
  display: block;
  font-family: 'DM Mono', monospace;
  font-size: 0.6rem;
  letter-spacing: 0.4em;
  color: var(--muted);
  margin-top: 8px;
  text-transform: uppercase;
}

/* Module cards grid */
.module-cards {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
  width: 100%;
}
@media (max-width: 640px) { .module-cards { grid-template-columns: 1fr; } }

.module-card {
  background: var(--s1);
  border: 1px solid var(--border);
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 14px;
  position: relative;
  overflow: hidden;
  transition: border-color 0.2s;
}
.module-card::before {
  content: '';
  position: absolute; left: 0; top: 0; bottom: 0; width: 3px;
  background: var(--mc-color, var(--gold));
  opacity: 0.4;
  transition: opacity 0.3s;
}
.module-card.loaded { border-color: var(--mc-color, var(--gold)); }
.module-card.loaded::before { opacity: 1; }

.mc-header { display: flex; align-items: center; gap: 10px; }
.mc-icon { font-size: 1.4rem; line-height: 1; }
.mc-title {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 1.2rem;
  letter-spacing: 0.08em;
  color: var(--mc-color, var(--gold));
}
.mc-status {
  font-size: 9px;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  color: var(--muted);
  padding: 3px 8px;
  border: 1px solid var(--border);
  display: inline-block;
  margin-left: auto;
  flex-shrink: 0;
}
.mc-status.ok { border-color: var(--mc-color, var(--gold)); color: var(--mc-color, var(--gold)); }

.mc-cols {
  font-size: 9px;
  color: var(--muted2);
  letter-spacing: 0.06em;
  line-height: 1.8;
}

.mc-info {
  font-size: 9px;
  color: var(--muted);
  letter-spacing: 0.06em;
  min-height: 28px;
}
.mc-info.ok { color: var(--green); }

.mc-actions { display: flex; gap: 8px; margin-top: auto; }

.btn-upload {
  flex: 1;
  padding: 8px 12px;
  background: none;
  border: 1px solid var(--border);
  color: var(--muted);
  font-family: 'DM Mono', monospace;
  font-size: 9px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  cursor: pointer;
  transition: all 0.2s;
}
.btn-upload:hover { border-color: var(--mc-color, var(--gold)); color: var(--mc-color, var(--gold)); }

.btn-load-snap {
  flex: 1;
  padding: 8px 12px;
  background: rgba(212,168,67,0.08);
  border: 1px solid var(--gold-dim);
  color: var(--gold);
  font-family: 'DM Mono', monospace;
  font-size: 9px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  cursor: pointer;
  transition: all 0.2s;
  display: none;
}
.btn-load-snap.visible { display: block; }
.btn-load-snap:hover { border-color: var(--gold); background: rgba(212,168,67,0.16); }

.btn-clear-snap {
  padding: 8px 10px;
  background: none;
  border: 1px solid var(--border);
  color: var(--muted2);
  font-family: 'DM Mono', monospace;
  font-size: 9px;
  cursor: pointer;
  transition: all 0.2s;
  display: none;
}
.btn-clear-snap.visible { display: block; }
.btn-clear-snap:hover { border-color: var(--rose); color: var(--rose); }

/* Bottom setup actions */
.setup-footer {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  width: 100%;
}
.setup-hint {
  font-size: 9px;
  color: var(--muted);
  letter-spacing: 0.1em;
  text-align: center;
}
.btn-view-bi {
  padding: 12px 40px;
  background: var(--gold);
  color: var(--bg);
  font-family: 'DM Mono', monospace;
  font-size: 11px;
  font-weight: 500;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  border: none;
  cursor: pointer;
  transition: all 0.25s;
  opacity: 0.35;
  pointer-events: none;
}
.btn-view-bi.active { opacity: 1; pointer-events: auto; }
.btn-view-bi.active:hover { background: var(--gold2); transform: translateY(-1px); }

.btn-mirror {
  padding: 14px 48px;
  background: var(--green);
  color: #fff;
  font-family: 'DM Mono', monospace;
  font-size: 12px;
  font-weight: 500;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  border: none;
  cursor: pointer;
  transition: all 0.25s;
  display: none;
}
.btn-mirror.active { display: block; }
.btn-mirror:hover { background: #3d8a5e; transform: translateY(-1px); }
.mirror-hint {
  font-size: 9px;
  color: var(--green);
  letter-spacing: 0.12em;
  text-align: center;
  display: none;
}
.mirror-hint.active { display: block; }

/*  LOADING  */
#loading-screen {
  display: none;
  position: fixed; inset: 0;
  background: var(--bg);
  z-index: 1000;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  gap: 20px;
}
.load-bar { width: 200px; height: 2px; background: var(--s3); overflow: hidden; }
.load-bar-fill { height: 100%; background: var(--gold); animation: loadAnim 1.2s ease-in-out infinite; }
@keyframes loadAnim {
  0% { width: 0; transform: translateX(0); }
  50% { width: 60%; }
  100% { width: 0; transform: translateX(200px); }
}
.load-text { font-size: 10px; letter-spacing: 0.3em; color: var(--muted); text-transform: uppercase; }

/*  BI SCREEN  */
#bi-screen { display: none; }

.topbar {
  background: var(--s1);
  border-bottom: 1px solid var(--border);
  padding: 0 24px;
  height: 52px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: sticky; top: 0; z-index: 100;
}
.topbar-logo {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 1.5rem;
  letter-spacing: 0.1em;
  color: var(--gold);
}
.topbar-right { display: flex; align-items: center; gap: 10px; }

.btn-export {
  padding: 6px 14px;
  border: 1px solid var(--gold-dim);
  background: rgba(212,168,67,0.08);
  color: var(--gold);
  font-family: 'DM Mono', monospace;
  font-size: 10px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  cursor: pointer;
  transition: all 0.2s;
}
.btn-export:hover { border-color: var(--gold); background: rgba(212,168,67,0.16); }

.btn-back {
  padding: 6px 14px;
  border: 1px solid var(--border);
  background: none;
  color: var(--muted);
  font-family: 'DM Mono', monospace;
  font-size: 10px;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  cursor: pointer;
  transition: all 0.2s;
}
.btn-back:hover { border-color: var(--gold); color: var(--gold); }

/* Nav */
.nav-tabs {
  background: var(--s1);
  border-bottom: 1px solid var(--border);
  display: flex;
  padding: 0 24px;
  overflow-x: auto;
}
.nav-tab {
  padding: 12px 20px;
  font-size: 10px;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: var(--muted);
  cursor: pointer;
  border-bottom: 2px solid transparent;
  transition: all 0.2s;
  white-space: nowrap;
  background: none;
  border-top: none; border-left: none; border-right: none;
  font-family: 'DM Mono', monospace;
}
.nav-tab:hover { color: var(--text); }
.nav-tab.active { color: var(--gold); border-bottom-color: var(--gold); }
.nav-tab.tab-compras.active { color: var(--teal); border-bottom-color: var(--teal); }
.nav-tab.tab-comissoes.active { color: var(--violet); border-bottom-color: var(--violet); }
.nav-tab.disabled { opacity: 0.3; cursor: default; pointer-events: none; }
.tab-dot {
  display: inline-block; width: 5px; height: 5px; border-radius: 50%;
  background: currentColor; margin-left: 6px; vertical-align: middle; opacity: 0.6;
}

/* Content */
.content { padding: 24px; max-width: 1400px; margin: 0 auto; }

/* Pages */
.page { display: none; }
.page.active { display: block; }

/*  KPI ROW  */
.kpi-row {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
  margin-bottom: 24px;
}
@media (min-width: 600px) { .kpi-row { grid-template-columns: repeat(3, 1fr); } }
@media (min-width: 900px) { .kpi-row { grid-template-columns: repeat(5, 1fr); } }

.kpi {
  background: var(--s1);
  border: 1px solid var(--border);
  padding: 16px;
  position: relative; overflow: hidden;
  transition: border-color 0.2s;
}
.kpi::after {
  content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 2px;
  background: var(--kpi-color, var(--gold));
  transform: scaleX(0); transition: transform 0.4s ease; transform-origin: left;
}
.kpi:hover::after { transform: scaleX(1); }
.kpi:hover { border-color: var(--kpi-color, var(--gold)); }
.kpi-label { font-size: 9px; text-transform: uppercase; letter-spacing: 0.2em; color: var(--muted); margin-bottom: 8px; }
.kpi-value { font-family: 'Bebas Neue', sans-serif; font-size: 2rem; letter-spacing: 0.03em; color: var(--kpi-color, var(--gold)); line-height: 1; margin-bottom: 4px; }
.kpi-sub { font-size: 10px; color: var(--muted); }

/*  PANELS  */
.panel { background: var(--s1); border: 1px solid var(--border); padding: 20px; }
.panel-hd {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid var(--border);
}
.panel-title { font-size: 9px; text-transform: uppercase; letter-spacing: 0.22em; color: var(--muted); }
.panel-badge { font-size: 9px; padding: 3px 8px; background: var(--s3); color: var(--muted); letter-spacing: 0.1em; }

/*  GRIDS  */
.grid-2 { display: grid; grid-template-columns: 1fr; gap: 16px; margin-bottom: 20px; }
@media (min-width: 768px) { .grid-2 { grid-template-columns: 1.4fr 1fr; } }
.grid-2-eq { display: grid; grid-template-columns: 1fr; gap: 16px; margin-bottom: 20px; }
@media (min-width: 768px) { .grid-2-eq { grid-template-columns: 1fr 1fr; } }
.grid-3 { display: grid; grid-template-columns: 1fr; gap: 16px; margin-bottom: 20px; }
@media (min-width: 900px) { .grid-3 { grid-template-columns: 1fr 1fr 1fr; } }
.mb20 { margin-bottom: 20px; }

/*  CHARTS  */
.chart-box { position: relative; }
.chart-box canvas { max-height: 280px; }

/*  RANK LIST  */
.rank-list { display: flex; flex-direction: column; gap: 8px; }
.rank-item { display: flex; align-items: center; gap: 10px; padding: 8px 0; border-bottom: 1px solid var(--border); }
.rank-item:last-child { border-bottom: none; }
.rank-num { font-family: 'Bebas Neue', sans-serif; font-size: 1.2rem; color: var(--muted2); width: 28px; flex-shrink: 0; text-align: center; }
.rank-num.top { color: var(--gold); }
.rank-info { flex: 1; min-width: 0; }
.rank-name { font-size: 11px; color: var(--text); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.rank-cat { font-size: 9px; color: var(--muted); margin-top: 2px; letter-spacing: 0.08em; }
.rank-right { text-align: right; flex-shrink: 0; }
.rank-val { font-size: 11px; color: var(--gold); }
.rank-bar-wrap { width: 60px; height: 3px; background: var(--s3); margin-top: 4px; }
.rank-bar { height: 100%; background: var(--gold); transition: width 0.8s ease; }

/*  TABLE  */
.table-wrap { overflow-x: auto; -webkit-overflow-scrolling: touch; }
table { width: 100%; border-collapse: collapse; min-width: 480px; }
thead tr { position: sticky; top: 0; }
th {
  font-size: 9px; text-transform: uppercase; letter-spacing: 0.2em; color: var(--muted);
  padding: 8px 12px; text-align: left; background: var(--s2);
  border-bottom: 1px solid var(--border); white-space: nowrap;
  font-weight: 400; user-select: none; transition: color 0.15s;
}
td { padding: 9px 12px; border-bottom: 1px solid #18181b; font-size: 11px; white-space: nowrap; }
tr:hover td { background: var(--s2); }
.td-val { color: var(--gold); text-align: right; }
.td-num { color: var(--muted); }
.td-right { text-align: right; }
.td-green { color: var(--green); text-align: right; }
.td-rose { color: var(--rose); text-align: right; }
.td-blue { color: var(--blue); text-align: right; }
.td-violet { color: var(--violet); text-align: right; }
.td-badge {
  font-size: 9px; padding: 2px 6px; border: 1px solid var(--border);
  color: var(--muted); display: inline-block; letter-spacing: 0.08em;
}

/*  FILTER BAR  */
.filter-bar {
  background: var(--s1); border: 1px solid var(--border);
  padding: 14px 20px; margin-bottom: 20px;
  display: flex; align-items: center; gap: 12px; flex-wrap: wrap;
}
.filter-label { font-size: 9px; text-transform: uppercase; letter-spacing: 0.2em; color: var(--muted); flex-shrink: 0; }
.search-box {
  padding: 6px 12px; background: var(--s2); border: 1px solid var(--border);
  color: var(--text); font-family: 'DM Mono', monospace; font-size: 11px;
  outline: none; width: 200px; transition: border-color 0.2s;
}
.search-box:focus { border-color: var(--gold); }
.search-box::placeholder { color: var(--muted2); }

/*  CAT FILTER CHIPS  */
.cat-filter-bar {
  display: flex; gap: 6px; flex-wrap: wrap; margin-bottom: 20px; align-items: center;
}
.cat-chip {
  padding: 5px 12px; font-size: 9px; letter-spacing: 0.1em; text-transform: uppercase;
  border: 1px solid var(--border); color: var(--muted); cursor: pointer;
  transition: all 0.15s; background: none; font-family: 'DM Mono', monospace;
  white-space: nowrap;
}
.cat-chip:hover { border-color: var(--chip-color, var(--gold)); color: var(--chip-color, var(--gold)); }
.cat-chip.active { background: var(--chip-color, var(--gold)); color: var(--bg); border-color: var(--chip-color, var(--gold)); }
.cat-chip-all { --chip-color: var(--muted); }
.cat-chip-all.active { background: var(--s3); color: var(--text); border-color: var(--muted); }

/*  CAT SUMMARY CARDS  */
.cat-cards-grid {
  display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 20px;
}
@media (min-width: 600px) { .cat-cards-grid { grid-template-columns: repeat(3, 1fr); } }
@media (min-width: 900px) { .cat-cards-grid { grid-template-columns: repeat(4, 1fr); } }

.cat-summary-card {
  background: var(--s1); border: 1px solid var(--border); padding: 14px;
  cursor: pointer; transition: all 0.2s; position: relative; overflow: hidden;
}
.cat-summary-card::before {
  content:''; position:absolute; left:0; top:0; bottom:0; width:3px;
  background: var(--cc, var(--gold));
}
.cat-summary-card:hover { border-color: var(--cc, var(--gold)); transform: translateY(-1px); }
.cat-summary-card.active-card { border-color: var(--cc, var(--gold)); background: var(--s2); }
.cscard-name { font-size: 9px; color: var(--text); margin-bottom: 6px; padding-left: 8px; letter-spacing:.04em; line-height:1.3; }
.cscard-val { font-family:'Bebas Neue',sans-serif; font-size:1.3rem; color:var(--cc,var(--gold)); padding-left:8px; }
.cscard-sub { font-size:9px; color:var(--muted); padding-left:8px; margin-top:2px; }

/*  OVERVIEW SECTION HEADER  */
.section-hd {
  display: flex; align-items: center; gap: 10px;
  margin-bottom: 16px; padding-bottom: 10px; border-bottom: 1px solid var(--border);
}
.section-hd-label {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 1.1rem; letter-spacing: 0.1em;
  color: var(--section-color, var(--gold));
}
.section-hd-sub { font-size: 9px; color: var(--muted); letter-spacing: 0.15em; margin-left: auto; }

/*  EMPTY  */
.empty { text-align: center; padding: 40px; color: var(--muted); font-size: 11px; letter-spacing: 0.1em; }
.module-missing {
  border: 1px dashed var(--border); padding: 28px; text-align: center;
  color: var(--muted2); font-size: 10px; letter-spacing: 0.12em; margin-bottom: 20px;
}
.module-missing strong { color: var(--muted); display: block; margin-bottom: 6px; font-weight: 400; }

/*  ANIMATIONS  */
@keyframes fadeUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
.fade-up { animation: fadeUp 0.4s ease forwards; opacity: 0; }
.fade-up:nth-child(1) { animation-delay: 0.02s; }
.fade-up:nth-child(2) { animation-delay: 0.05s; }
.fade-up:nth-child(3) { animation-delay: 0.08s; }
.fade-up:nth-child(4) { animation-delay: 0.11s; }
.fade-up:nth-child(5) { animation-delay: 0.14s; }

/*  SCROLLBAR  */
::-webkit-scrollbar { width: 4px; height: 4px; }
::-webkit-scrollbar-track { background: var(--bg); }
::-webkit-scrollbar-thumb { background: var(--border); }
::-webkit-scrollbar-thumb:hover { background: var(--muted2); }

/*  TOAST  */
#toast {
  position: fixed; bottom: 24px; right: 24px;
  background: var(--s2); border: 1px solid var(--gold-dim);
  color: var(--gold); font-size: 10px; letter-spacing: 0.12em;
  text-transform: uppercase; padding: 10px 18px;
  z-index: 9999; opacity: 0; transform: translateY(8px);
  transition: all 0.3s ease; pointer-events: none;
}
#toast.show { opacity: 1; transform: translateY(0); }

/*  MOBILE  */
@media (max-width: 640px) {
  .topbar { height: 48px; padding: 0 14px; }
  .topbar-logo { font-size: 1.2rem; }
  .btn-export, .btn-back { padding: 5px 10px; font-size: 9px; }
  .nav-tabs { padding: 0 8px; }
  .nav-tab { padding: 10px 12px; font-size: 9px; letter-spacing: 0.1em; }
  .content { padding: 12px 10px; }
  .kpi-row { grid-template-columns: 1fr 1fr !important; gap: 8px; }
  .kpi:first-child { grid-column: 1 / -1; }
  .kpi { padding: 12px 10px; }
  .kpi-value { font-size: 1.6rem; }
  .grid-2, .grid-2-eq, .grid-3 { grid-template-columns: 1fr !important; }
  .chart-box canvas { max-height: 200px !important; }
  .panel { padding: 14px 12px; }
  .rank-bar-wrap { width: 40px; }
  .search-box { width: 100%; }
  .filter-bar { flex-direction: column; align-items: flex-start; }
  #toast { bottom: 14px; right: 10px; left: 10px; text-align: center; }
  .setup-logo { font-size: 2.8rem; }
}
</style>
</head>
<body>

<!--  SETUP SCREEN  -->
<div id="setup-screen">
  <div class="setup-grid-bg"></div>
  <div class="setup-inner">

    <div class="setup-logo">
      BI  HUB
      <span>Central de Dados  Vendas  Compras  Comisses</span>
    </div>

    <div class="module-cards">

      <!-- VENDAS -->
      <div class="module-card" id="card-vendas" style="--mc-color: var(--gold)">
        <div class="mc-header">
          <div class="mc-icon"></div>
          <div class="mc-title">Vendas</div>
          <div class="mc-status" id="status-vendas">Aguardando</div>
        </div>
        <div class="mc-cols">Subgrupo  Produto<br>Quantidade  Valor Total</div>
        <div class="mc-info" id="info-vendas">Nenhum dado carregado</div>
        <div class="mc-actions">
          <button class="btn-upload" onclick="triggerUpload('vendas')"> Upload</button>
          <button class="btn-load-snap" id="snap-load-vendas" onclick="loadSnap('vendas')"> Carregar</button>
          <button class="btn-clear-snap" id="snap-clear-vendas" onclick="clearSnap('vendas')" title="Apagar snapshot"></button>
        </div>
        <input type="file" id="file-vendas" accept=".xlsx,.xls,.csv" style="display:none">
      </div>

      <!-- COMPRAS -->
      <div class="module-card" id="card-compras" style="--mc-color: var(--teal)">
        <div class="mc-header">
          <div class="mc-icon"></div>
          <div class="mc-title">Compras</div>
          <div class="mc-status" id="status-compras">Aguardando</div>
        </div>
        <div class="mc-cols">Data  Produto  Fornecedor<br>Quantidade  Valor</div>
        <div class="mc-info" id="info-compras">Nenhum dado carregado</div>
        <div class="mc-actions">
          <button class="btn-upload" style="border-color: inherit" onclick="triggerUpload('compras')"> Upload</button>
          <button class="btn-load-snap" id="snap-load-compras" onclick="loadSnap('compras')"> Carregar</button>
          <button class="btn-clear-snap" id="snap-clear-compras" onclick="clearSnap('compras')" title="Apagar snapshot"></button>
        </div>
        <input type="file" id="file-compras" accept=".xlsx,.xls,.csv" style="display:none">
      </div>

      <!-- COMISSES -->
      <div class="module-card" id="card-comissoes" style="--mc-color: var(--violet)">
        <div class="mc-header">
          <div class="mc-icon"></div>
          <div class="mc-title">Comisses</div>
          <div class="mc-status" id="status-comissoes">Aguardando</div>
        </div>
        <div class="mc-cols">Atendente  Realizado<br>Esperado  Repique  Receber</div>
        <div class="mc-info" id="info-comissoes">Nenhum dado carregado</div>
        <div class="mc-actions">
          <button class="btn-upload" onclick="triggerUpload('comissoes')"> Upload</button>
          <button class="btn-load-snap" id="snap-load-comissoes" onclick="loadSnap('comissoes')"> Carregar</button>
          <button class="btn-clear-snap" id="snap-clear-comissoes" onclick="clearSnap('comissoes')" title="Apagar snapshot"></button>
        </div>
        <input type="file" id="file-comissoes" accept=".xlsx,.xls,.csv" style="display:none">
      </div>

    </div>

    <div class="setup-footer">
      <div class="setup-hint">Carregue ao menos um mdulo para acessar o painel  Os dados ficam 100% no seu navegador</div>
      <button class="btn-view-bi" id="btn-view-bi" onclick="openBI()">Ver Painel </button>
      <button class="btn-mirror" id="btn-mirror" onclick="exportDashboard()"> Baixar Espelho para Enviar</button>
      <div class="mirror-hint" id="mirror-hint">Gera um arquivo .html com os dados embutidos  basta abrir no navegador</div>
    </div>

  </div>
</div>

<!--  LOADING  -->
<div id="loading-screen">
  <div class="load-text" id="load-text">Processando dados</div>
  <div class="load-bar"><div class="load-bar-fill"></div></div>
</div>

<!--  BI SCREEN  -->
<div id="bi-screen">

  <div class="topbar">
    <div class="topbar-logo">BI  HUB</div>
    <div class="topbar-right">
      <button class="btn-export" onclick="exportDashboard()"> Exportar</button>
      <button class="btn-back" onclick="goBack()"> Mdulos</button>
    </div>
  </div>

  <div class="nav-tabs">
    <button class="nav-tab active" onclick="showPage('overview', this)">Viso Geral</button>
    <button class="nav-tab" id="tab-vendas" onclick="showPage('vendas', this)">Vendas</button>
    <button class="nav-tab tab-compras" id="tab-compras" onclick="showPage('compras', this)">Compras</button>
    <button class="nav-tab tab-comissoes" id="tab-comissoes" onclick="showPage('comissoes', this)">Comisses</button>
  </div>

  <div class="content">

    <!--  VISO GERAL  -->
    <div class="page active" id="page-overview"></div>

    <!--  VENDAS  -->
    <div class="page" id="page-vendas"></div>

    <!--  COMPRAS  -->
    <div class="page" id="page-compras"></div>

    <!--  COMISSES  -->
    <div class="page" id="page-comissoes"></div>

  </div>
</div>

<div id="toast"></div>

<script>
/*  CAPTURE CLEAN SOURCE (before any DOM mutation)  */
const __SRC__ = document.documentElement.outerHTML;

/*  STATE  */
let VENDAS    = window.__BI_VENDAS__    || [];
let COMPRAS   = window.__BI_COMPRAS__   || [];
let COMISSOES = window.__BI_COMISSOES__ || [];

let charts = {}; // keyed by id

const SNAP_KEYS = { vendas: 'bihub_vendas', compras: 'bihub_compras', comissoes: 'bihub_comissoes' };
const DATA_REFS = { vendas: () => VENDAS, compras: () => COMPRAS, comissoes: () => COMISSOES };

const COLORS = [
  '#d4a843','#4d9e6e','#4a7fa0','#b05a4a','#7a5ab8',
  '#8a9e4d','#a04a7f','#4aa08a','#9e7a4d','#4d5a9e',
  '#3a8a8a','#b07040','#507ab0','#7a4db0','#4db080',
];

const fmt  = v => 'R$ ' + Number(v).toLocaleString('pt-BR', {minimumFractionDigits:2, maximumFractionDigits:2});
const fmtN = v => Number(v).toLocaleString('pt-BR');
const fmtP = v => Number(v).toFixed(1) + '%';
const parseNum = raw => {
  if (raw == null) return 0;
  if (typeof raw === 'number') return raw;
  return parseFloat(String(raw).replace(/R\$\s*/g,'').replace(/\./g,'').replace(',','.').trim()) || 0;
};

/*  TOAST  */
function showToast(msg, dur=2800) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), dur);
}

/*  UPLOAD TRIGGER  */
function triggerUpload(mod) {
  const el = document.getElementById('file-' + mod);
  el.onchange = e => { if (e.target.files[0]) processFile(mod, e.target.files[0]); el.value=''; };
  el.click();
}

/*  SNAPSHOTS  */
function saveSnap(mod, data, fileName) {
  try {
    localStorage.setItem(SNAP_KEYS[mod], JSON.stringify({
      fileName, savedAt: new Date().toLocaleString('pt-BR'), data
    }));
  } catch(e) { console.warn('Snap save failed', e); }
}

function loadSnap(mod) {
  try {
    const raw = localStorage.getItem(SNAP_KEYS[mod]);
    if (!raw) return;
    const snap = JSON.parse(raw);
    setData(mod, snap.data);
    updateCard(mod, snap.fileName, snap.data.length);
    showToast(' ' + mod + ' carregado do snapshot');
    updateViewButton();
  } catch(e) { alert('Erro ao carregar snapshot de ' + mod); }
}

function clearSnap(mod) {
  localStorage.removeItem(SNAP_KEYS[mod]);
  document.getElementById('snap-load-' + mod).classList.remove('visible');
  document.getElementById('snap-clear-' + mod).classList.remove('visible');
  showToast(' Snapshot de ' + mod + ' apagado');
}

function checkSnaps() {
  ['vendas','compras','comissoes'].forEach(mod => {
    try {
      const raw = localStorage.getItem(SNAP_KEYS[mod]);
      if (!raw) return;
      const snap = JSON.parse(raw);
      document.getElementById('snap-load-' + mod).classList.add('visible');
      document.getElementById('snap-clear-' + mod).classList.add('visible');
      document.getElementById('info-' + mod).textContent =
        ' ' + snap.fileName + '  ' + snap.data.length + ' registros  ' + snap.savedAt;
    } catch(e) {}
  });
}

function setData(mod, data) {
  if (mod === 'vendas')    VENDAS    = data;
  if (mod === 'compras')   COMPRAS   = data;
  if (mod === 'comissoes') COMISSOES = data;
}

function updateCard(mod, fileName, count) {
  const card = document.getElementById('card-' + mod);
  const status = document.getElementById('status-' + mod);
  const info = document.getElementById('info-' + mod);
  card.classList.add('loaded');
  status.classList.add('ok');
  status.textContent = ' OK';
  info.classList.add('ok');
  info.textContent = ' ' + fileName + '  ' + count + ' registros';
  document.getElementById('snap-clear-' + mod).classList.add('visible');
}

function updateViewButton() {
  const any = VENDAS.length > 0 || COMPRAS.length > 0 || COMISSOES.length > 0;
  document.getElementById('btn-view-bi').classList.toggle('active', any);
  document.getElementById('btn-mirror').classList.toggle('active', any);
  document.getElementById('mirror-hint').classList.toggle('active', any);
}

/*  FILE PROCESSING  */
function processFile(mod, file) {
  const ls = document.getElementById('loading-screen');
  document.getElementById('load-text').textContent = 'Processando ' + mod + '...';
  ls.style.display = 'flex';

  setTimeout(() => {
    const reader = new FileReader();
    reader.onload = e => {
      try {
        let data;
        if (file.name.endsWith('.csv')) {
          data = parseCSV(mod, e.target.result);
        } else {
          const wb = XLSX.read(e.target.result, { type: 'array' });
          const sheetName = wb.SheetNames[0];
          const json = XLSX.utils.sheet_to_json(wb.Sheets[sheetName], { header: 1 });
          data = parseSheet(mod, json);
        }

        if (!data || data.length === 0) throw new Error('Nenhum dado encontrado');

        setData(mod, data);
        saveSnap(mod, data, file.name);
        updateCard(mod, file.name, data.length);
        updateViewButton();
        ls.style.display = 'none';
        showToast(' ' + file.name + ' carregado  ' + data.length + ' registros');
      } catch(err) {
        ls.style.display = 'none';
        alert('Erro ao ler ' + mod + ': ' + err.message);
      }
    };
    if (file.name.endsWith('.csv')) reader.readAsText(file, 'latin1');
    else reader.readAsArrayBuffer(file);
  }, 80);
}

function findCol(norm, ...terms) {
  return norm.findIndex(c => c != null && terms.some(t => c === t || c.includes(t)));
}

function findHeaderRow(json, ...requiredTerms) {
  for (let i = 0; i < Math.min(json.length, 25); i++) {
    const row = json[i];
    if (!row || row.length < 2) continue;
    // Array.from garante array denso sem buracos
    const norm = Array.from(row, c => String(c == null ? '' : c).toUpperCase().trim());
    if (requiredTerms.every(t => norm.some(c => c.includes(t)))) return i;
  }
  return 0;
}

function parseSheet(mod, json) {
  if (mod === 'vendas')    return parseVendas(json);
  if (mod === 'compras')   return parseCompras(json);
  if (mod === 'comissoes') return parseComissoes(json);
}

/*  PARSE: VENDAS  */
function parseVendas(json) {
  let hRow = -1, colMap = {};
  for (let i = 0; i < Math.min(json.length, 15); i++) {
    const row = json[i]; if (!row || row.length < 3) continue;
    const norm = Array.from(row, c => String(c == null ? '' : c).toUpperCase().trim());
    const subIdx  = findCol(norm,'SUBGRUPO');
    const grupoIdx= findCol(norm,'GRUPO');
    const prodIdx = findCol(norm,'PRODUTO','DESCRI');
    const qtyIdx  = findCol(norm,'QUANTIDADE','QTDE','QTD');
    const valIdxes= norm.reduce((a,c,i) => (c==='VALOR'||c==='VALOR TOTAL'||c.includes('VALOR'))?[...a,i]:a,[]);
    const valIdx  = valIdxes.length > 0 ? valIdxes[valIdxes.length-1] : -1;
    const catIdx  = subIdx >= 0 ? subIdx : grupoIdx;
    if (catIdx>=0 && prodIdx>=0 && qtyIdx>=0 && valIdx>=0) { hRow=i; colMap={cat:catIdx,prod:prodIdx,qty:qtyIdx,val:valIdx}; break; }
  }
  if (hRow===-1) { hRow=0; colMap={cat:0,prod:1,qty:2,val:3}; }

  const data = [];
  for (let i = hRow+1; i < json.length; i++) {
    const row = json[i]; if (!row||row.length<3) continue;
    const cat  = String(row[colMap.cat]||'').trim();
    const prod = String(row[colMap.prod]||'').trim();
    if (!cat||!prod||prod.length<2) continue;
    if (/total\s*geral|^total$/i.test(cat)||/total\s*geral|^total$/i.test(prod)) continue;
    const qty = parseNum(row[colMap.qty]);
    const val = parseNum(row[colMap.val]);
    if (val < 0.5) continue;
    data.push({ cat, prod, qty, val });
  }
  return data;
}

/*  PARSE: COMPRAS  */
function parseCompras(json) {
  let hRow = -1, colMap = {};
  for (let i = 0; i < Math.min(json.length, 20); i++) {
    const row = json[i]; if (!row || row.length < 3) continue;
    const norm = Array.from(row, c => String(c == null ? '' : c).toUpperCase().trim());
    const dateIdx = findCol(norm,'DATA','DATE');
    const prodIdx = findCol(norm,'PRODUTO','DESCRI','ITEM');
    const supIdx  = findCol(norm,'FORNECEDOR','SUPPLIER','FORNEC');
    const qtyIdx  = findCol(norm,'QTDE','QUANTIDADE','QTD');
    const unitIdx = findCol(norm,'UN','UNIDADE','UNIT');
    // Valor: pega o ltimo ndice que contm VALOR
    const valIdxes = norm.reduce((a,c,i) => (c==='VALOR'||c.includes('VALOR')) ? [...a,i] : a, []);
    const valIdx   = valIdxes.length > 0 ? valIdxes[valIdxes.length-1] : -1;
    if (prodIdx >= 0 && valIdx >= 0) {
      hRow = i;
      colMap = { date: dateIdx, prod: prodIdx, supplier: supIdx, qty: qtyIdx, unit: unitIdx, val: valIdx };
      break;
    }
  }
  if (hRow === -1) { hRow = 11; colMap = { date:0, prod:2, supplier:3, qty:5, unit:6, val:7 }; }

  const data = [];
  for (let i = hRow+1; i < json.length; i++) {
    const row = json[i]; if (!row || row.length < 3) continue;
    const prod     = String(row[colMap.prod]||'').trim();
    const supplier = colMap.supplier >= 0 ? String(row[colMap.supplier]||'').trim() : '';
    if (!prod || prod.length < 2) continue;
    if (/total/i.test(prod)) continue;
    const qty = parseNum(colMap.qty >= 0 ? row[colMap.qty] : 0);
    const val = parseNum(row[colMap.val]);
    if (val < 0.01) continue;
    let date = '';
    if (colMap.date >= 0 && row[colMap.date]) {
      const raw = row[colMap.date];
      if (raw instanceof Date || (typeof raw === 'object' && raw !== null)) {
        date = raw.toLocaleDateString ? raw.toLocaleDateString('pt-BR') : String(raw).slice(0,10);
      } else if (typeof raw === 'number') {
        const d = new Date(Math.round((raw - 25569)*86400*1000));
        date = d.toLocaleDateString('pt-BR');
      } else { date = String(raw).trim(); }
    }
    const unit = colMap.unit >= 0 ? String(row[colMap.unit]||'').trim() : '';
    data.push({ date, prod, supplier, qty, unit, val });
  }
  return data;
}

/*  PARSE: COMISSES  */
function parseComissoes(json) {
  let hRow = -1, colMap = {};
  for (let i = 0; i < Math.min(json.length, 25); i++) {
    const row = json[i]; if (!row || row.length < 3) continue;
    const norm = Array.from(row, c => String(c == null ? '' : c).toUpperCase().trim());
    const atenIdx  = findCol(norm,'ATENDENTE','FUNCIONARIO','NOME');
    const espIdx   = findCol(norm,'ESPERADO');
    const realIdx  = findCol(norm,'REALIZADO');
    const repIdx   = findCol(norm,'REPIQUE');
    const recIdx   = findCol(norm,'RECEBER');
    const totIdx   = findCol(norm,'TOTAL');
    const atendIdx = findCol(norm,'ATENDIMENTO');
    const pctCIdx  = norm.findIndex(c => c != null && c.includes('COMISS') && c.includes('%'));
    const pctRIdx  = norm.findIndex(c => c != null && c.includes('REPIQUE') && c.includes('%'));
    const diIdx    = findCol(norm,'DATAINICIAL','DATA INICIAL');
    const dfIdx    = findCol(norm,'DATAFINAL','DATA FINAL');
    if (atenIdx >= 0 && (realIdx >= 0 || recIdx >= 0)) {
      hRow = i;
      colMap = { atendente:atenIdx, esperado:espIdx, realizado:realIdx, repique:repIdx,
                 receber:recIdx, total:totIdx, atendimentos:atendIdx,
                 pctComissao:pctCIdx, pctRepique:pctRIdx, dataInicial:diIdx, dataFinal:dfIdx };
      break;
    }
  }
  if (hRow === -1) return [];

  // Agrega por atendente (dados vm dirios, uma linha por dia por pessoa)
  const agg = {};
  const order = [];
  let periodoIni = '', periodoFim = '';

  for (let i = hRow+1; i < json.length; i++) {
    const row = json[i]; if (!row || row.length < 2) continue;
    const atendente = String(row[colMap.atendente]||'').trim();
    if (!atendente || atendente.length < 2) continue;
    if (/total/i.test(atendente)) continue;

    if (!agg[atendente]) {
      order.push(atendente);
      agg[atendente] = { atendente, atendimentos:0, esperado:0, realizado:0, repique:0, total:0, receber:0, pctComissao:0, pctRepique:0, dias:0 };
    }

    const get = idx => (idx >= 0 && row[idx] != null) ? parseNum(row[idx]) : 0;
    agg[atendente].atendimentos += get(colMap.atendimentos);
    agg[atendente].esperado     += get(colMap.esperado);
    agg[atendente].realizado    += get(colMap.realizado);
    agg[atendente].repique      += get(colMap.repique);
    agg[atendente].total        += get(colMap.total);
    agg[atendente].receber      += get(colMap.receber);
    agg[atendente].dias         += 1;
    // % comisso: pega o ltimo valor no-zero ( por pessoa, no por dia)
    const pc = get(colMap.pctComissao);
    const pr = get(colMap.pctRepique);
    if (pc > 0) agg[atendente].pctComissao = pc;
    if (pr > 0) agg[atendente].pctRepique  = pr;

    // Perodo
    if (!periodoIni && colMap.dataInicial >= 0 && row[colMap.dataInicial]) {
      const r = row[colMap.dataInicial];
      periodoIni = (r instanceof Date || typeof r === 'object') && r.toLocaleDateString
        ? r.toLocaleDateString('pt-BR') : String(r).slice(0,10);
    }
    if (colMap.dataFinal >= 0 && row[colMap.dataFinal]) {
      const r = row[colMap.dataFinal];
      periodoFim = (r instanceof Date || typeof r === 'object') && r.toLocaleDateString
        ? r.toLocaleDateString('pt-BR') : String(r).slice(0,10);
    }
  }

  const periodo = periodoIni ? (periodoIni + (periodoFim ? '  ' + periodoFim : '')) : '';
  return order.map(name => ({ ...agg[name], periodo }));
}

/*  OPEN BI  */
function openBI() {
  document.getElementById('setup-screen').style.display = 'none';
  document.getElementById('bi-screen').style.display = 'block';
  // Update tab visibility
  document.getElementById('tab-vendas').classList.toggle('disabled', VENDAS.length===0);
  document.getElementById('tab-compras').classList.toggle('disabled', COMPRAS.length===0);
  document.getElementById('tab-comissoes').classList.toggle('disabled', COMISSOES.length===0);
  requestAnimationFrame(() => setTimeout(buildBI, 50));
}

function goBack() {
  activeCatVendas = 'all';
  activeFornCompras = 'all';
  // destroy charts
  Object.values(charts).forEach(c => c && c.destroy && c.destroy());
  charts = {};
  document.getElementById('bi-screen').style.display = 'none';
  document.getElementById('setup-screen').style.display = 'flex';
  // reset pages
  ['overview','vendas','compras','comissoes'].forEach(p => {
    document.getElementById('page-' + p).innerHTML = '';
  });
}

/*  NAV  */
function showPage(pageId, tabEl) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
  document.getElementById('page-' + pageId).classList.add('active');
  if (tabEl) tabEl.classList.add('active');
}

let activeCatVendas  = 'all';
let activeFornCompras = 'all';

/*  BUILD BI  */
function buildBI() {
  buildOverview();
  if (VENDAS.length)    buildVendasPage();
  if (COMPRAS.length)   buildComprasPage();
  if (COMISSOES.length) buildComissoesPage();
}

/* 
   VISO GERAL
 */
function buildOverview() {
  const totalVendas   = VENDAS.reduce((s,d) => s+d.val, 0);
  const totalQty      = VENDAS.reduce((s,d) => s+d.qty, 0);
  const totalCompras  = COMPRAS.reduce((s,d) => s+d.val, 0);
  const totalComissoes= COMISSOES.reduce((s,d) => s+d.receber, 0);
  const margem        = totalVendas - totalCompras;
  const margemPct     = totalVendas > 0 ? (margem/totalVendas*100) : 0;

  // KPIs dinmicos baseados no que est disponvel
  const kpis = [];
  if (VENDAS.length)    kpis.push({ label:'Unidades Vendidas', value: fmtN(totalQty), sub:'itens vendidos', color:'var(--green)' });
  if (VENDAS.length)    kpis.push({ label:'Faturamento', value: fmt(totalVendas), sub:'vendas no perodo', color:'var(--gold)' });
  if (COMPRAS.length)   kpis.push({ label:'Total em Compras', value: fmt(totalCompras), sub:'custo de compras', color:'var(--teal)' });
  if (VENDAS.length && COMPRAS.length) kpis.push({ label:'Margem Bruta', value: fmtP(margemPct), sub: fmt(margem), color: margem>=0?'var(--green)':'var(--rose)' });
  if (COMISSOES.length) {
    const totalRec = COMISSOES.reduce((s,d)=>s+d.receber,0);
    const temReceber = totalRec > 0;
    kpis.push(temReceber
      ? { label:'Total Comisses', value: fmt(totalRec), sub: COMISSOES.length+' atendentes', color:'var(--violet)' }
      : { label:'Atingimento Geral', value: fmtP(totalVendas>0?(COMISSOES.reduce((s,d)=>s+d.realizado,0)/COMISSOES.reduce((s,d)=>s+d.esperado,0)*100):0), sub: COMISSOES.length+' atendentes', color:'var(--violet)' }
    );
  }

  let html = `<div class="kpi-row">` +
    kpis.map(k => `
      <div class="kpi fade-up" style="--kpi-color:${k.color}">
        <div class="kpi-label">${k.label}</div>
        <div class="kpi-value">${k.value}</div>
        <div class="kpi-sub">${k.sub}</div>
      </div>`).join('') +
  `</div>`;

  // Seo Vendas
  if (VENDAS.length) {
    const catMap = {};
    VENDAS.forEach(d => { if (!catMap[d.cat]) catMap[d.cat]={val:0,qty:0}; catMap[d.cat].val+=d.val; catMap[d.cat].qty+=d.qty; });
    const cats = Object.entries(catMap).map(([n,v])=>({name:n,...v})).sort((a,b)=>b.val-a.val);
    const top5 = [...VENDAS].sort((a,b)=>b.val-a.val).slice(0,8);

    html += `
    <div class="section-hd" style="--section-color:var(--gold)">
      <span class="section-hd-label"> Vendas</span>
      <span class="section-hd-sub">${VENDAS.length} produtos  ${cats.length} categorias</span>
    </div>
    <div class="grid-2 mb20">
      <div class="panel">
        <div class="panel-hd"><span class="panel-title">Faturamento por Categoria</span></div>
        <div class="chart-box"><canvas id="ov-chart-vendas"></canvas></div>
      </div>
      <div class="panel">
        <div class="panel-hd"><span class="panel-title">Top 8 Produtos  Faturamento</span></div>
        <div class="rank-list">
          ${top5.map((d,i) => `
          <div class="rank-item">
            <div class="rank-num ${i<3?'top':''}">${i<3?['','',''][i]:i+1}</div>
            <div class="rank-info"><div class="rank-name" title="${d.prod}">${d.prod}</div><div class="rank-cat">${d.cat}</div></div>
            <div class="rank-right">
              <div class="rank-val">${fmt(d.val)}</div>
              <div class="rank-bar-wrap"><div class="rank-bar" style="width:${(d.val/top5[0].val*100).toFixed(1)}%"></div></div>
            </div>
          </div>`).join('')}
        </div>
      </div>
    </div>`;

    setTimeout(() => {
      const ctx = document.getElementById('ov-chart-vendas');
      if (!ctx) return;
      charts['ov-vendas'] = new Chart(ctx.getContext('2d'), {
        type:'bar',
        data:{ labels: cats.slice(0,10).map(c=>c.name.length>18?c.name.slice(0,16)+'':c.name), datasets:[{ data:cats.slice(0,10).map(c=>c.val), backgroundColor:COLORS.map(c=>c+'bb'), borderColor:COLORS, borderWidth:1 }] },
        options:{ responsive:true, plugins:{ legend:{display:false}, tooltip:{ backgroundColor:'#111', callbacks:{ label:ctx=>' '+fmt(ctx.raw) } } },
          scales:{ x:{ticks:{color:'#5a5a52',font:{family:'DM Mono',size:8},maxRotation:40},grid:{color:'#1a1a1e'}}, y:{ticks:{color:'#6b6b60',font:{family:'DM Mono',size:9},callback:v=>'R$'+(v/1000).toFixed(0)+'k'},grid:{color:'#1a1a1e'}} } }
      });
    }, 100);
  }

  // Seo Compras
  if (COMPRAS.length) {
    const supMap = {};
    COMPRAS.forEach(d => { if (!supMap[d.supplier]) supMap[d.supplier]={val:0,qty:0,count:0}; supMap[d.supplier].val+=d.val; supMap[d.supplier].qty+=d.qty; supMap[d.supplier].count++; });
    const sups = Object.entries(supMap).map(([n,v])=>({name:n,...v})).sort((a,b)=>b.val-a.val).slice(0,8);

    html += `
    <div class="section-hd" style="--section-color:var(--teal)">
      <span class="section-hd-label"> Compras</span>
      <span class="section-hd-sub">${COMPRAS.length} notas  ${Object.keys(supMap).length} fornecedores</span>
    </div>
    <div class="panel mb20">
      <div class="panel-hd"><span class="panel-title">Top Fornecedores  Gasto Total</span></div>
      <div class="rank-list">
        ${sups.map((s,i) => `
        <div class="rank-item">
          <div class="rank-num ${i<3?'top':''}">${i<3?['','',''][i]:i+1}</div>
          <div class="rank-info"><div class="rank-name" title="${s.name}">${s.name}</div><div class="rank-cat">${s.count} compras  ${fmtN(s.qty)} un</div></div>
          <div class="rank-right">
            <div class="rank-val" style="color:var(--teal)">${fmt(s.val)}</div>
            <div class="rank-bar-wrap"><div class="rank-bar" style="width:${(s.val/sups[0].val*100).toFixed(1)}%;background:var(--teal)"></div></div>
          </div>
        </div>`).join('')}
      </div>
    </div>`;
  }

  // Seo Comisses
  if (COMISSOES.length) {
    const sorted = [...COMISSOES].sort((a,b)=>b.realizado-a.realizado);
    html += `
    <div class="section-hd" style="--section-color:var(--violet)">
      <span class="section-hd-label"> Comisses</span>
      <span class="section-hd-sub">${COMISSOES.length} atendentes</span>
    </div>
    <div class="grid-2 mb20">
      <div class="panel">
        <div class="panel-hd"><span class="panel-title">Realizado vs Esperado</span></div>
        <div class="chart-box"><canvas id="ov-chart-com"></canvas></div>
      </div>
      <div class="panel">
        <div class="panel-hd"><span class="panel-title">Ranking  A Receber</span></div>
        <div class="rank-list">
          ${sorted.slice(0,8).map((d,i)=>`
          <div class="rank-item">
            <div class="rank-num ${i<3?'top':''}">${i<3?['','',''][i]:i+1}</div>
            <div class="rank-info"><div class="rank-name">${d.atendente}</div><div class="rank-cat">${fmtN(d.atendimentos)} atend.  ${fmtP(d.pctComissao)} comisso</div></div>
            <div class="rank-right">
              <div class="rank-val" style="color:var(--violet)">${fmt(d.receber)}</div>
              <div class="rank-bar-wrap"><div class="rank-bar" style="width:${(d.receber/sorted[0].receber*100).toFixed(1)}%;background:var(--violet)"></div></div>
            </div>
          </div>`).join('')}
        </div>
      </div>
    </div>`;

    setTimeout(() => {
      const ctx = document.getElementById('ov-chart-com');
      if (!ctx) return;
      const labels = sorted.map(d => d.atendente.split(' ')[0]);
      charts['ov-com'] = new Chart(ctx.getContext('2d'), {
        type:'bar',
        data:{ labels, datasets:[
          { label:'Realizado', data:sorted.map(d=>d.realizado), backgroundColor:'#7a5ab8bb', borderColor:'#7a5ab8', borderWidth:1 },
          { label:'Esperado',  data:sorted.map(d=>d.esperado),  backgroundColor:'#4a4a4288', borderColor:'#6b6b60',  borderWidth:1, borderDash:[4,4] },
        ]},
        options:{ responsive:true, plugins:{ legend:{labels:{color:'#6b6b60',font:{family:'DM Mono',size:9},boxWidth:10}}, tooltip:{backgroundColor:'#111',callbacks:{label:ctx=>' '+fmt(ctx.raw)}} },
          scales:{ x:{ticks:{color:'#5a5a52',font:{family:'DM Mono',size:8},maxRotation:40},grid:{color:'#1a1a1e'}}, y:{ticks:{color:'#6b6b60',font:{family:'DM Mono',size:9},callback:v=>fmt(v).replace('R$ ','')},grid:{color:'#1a1a1e'}} } }
      });
    }, 120);
  }

  document.getElementById('page-overview').innerHTML = html;
}

/* 
   VENDAS PAGE
 */
function buildVendasPage() {
  activeCatVendas = 'all';
  document.getElementById('page-vendas').innerHTML = `
    <div id="v-cat-filter" class="cat-filter-bar"></div>
    <div id="v-kpis" class="kpi-row"></div>
    <div id="v-cat-cards" class="cat-cards-grid"></div>
    <div id="v-charts" class="grid-2 mb20"></div>
    <div id="v-ranks" class="grid-2-eq mb20"></div>
    <div id="v-table" class="panel"></div>
  `;
  renderVendasFilter();
  renderVendasContent();
}

function renderVendasFilter() {
  const cats = [...new Set(VENDAS.map(d => d.cat))].sort();
  const bar = document.getElementById('v-cat-filter');
  if (!bar) return;
  bar.innerHTML = [
    `<button class="cat-chip cat-chip-all ${activeCatVendas==='all'?'active':''}" onclick="setVendasCat(this)" data-val="all">Todas</button>`,
    ...cats.map((c,i) => `<button class="cat-chip ${activeCatVendas===c?'active':''}" style="--chip-color:${COLORS[i%COLORS.length]}" onclick="setVendasCat(this)" data-val="${c.replace(/"/g,'&quot;')}">${c}</button>`)
  ].join('');
}

function setVendasCat(el) {
  activeCatVendas = el.dataset.val;
  renderVendasFilter();
  renderVendasContent();
}

function renderVendasContent() {
  const data   = activeCatVendas === 'all' ? VENDAS : VENDAS.filter(d => d.cat === activeCatVendas);
  const total  = data.reduce((s,d) => s+d.val, 0);
  const qty    = data.reduce((s,d) => s+d.qty, 0);
  const totalAll = VENDAS.reduce((s,d) => s+d.val, 0);
  const isCat  = activeCatVendas !== 'all';

  // KPIs
  const kpisEl = document.getElementById('v-kpis');
  if (kpisEl) kpisEl.innerHTML = `
    <div class="kpi fade-up" style="--kpi-color:var(--green)"><div class="kpi-label">Unidades Vendidas</div><div class="kpi-value">${fmtN(qty)}</div><div class="kpi-sub">${isCat ? activeCatVendas : 'todos os itens'}</div></div>
    <div class="kpi fade-up" style="--kpi-color:var(--gold)"><div class="kpi-label">Faturamento</div><div class="kpi-value">${fmt(total)}</div><div class="kpi-sub">${isCat ? fmtP(total/totalAll*100)+' do total' : 'perodo completo'}</div></div>
    <div class="kpi fade-up" style="--kpi-color:var(--blue)"><div class="kpi-label">${isCat ? 'Produtos' : 'Categorias'}</div><div class="kpi-value">${isCat ? data.length : [...new Set(data.map(d=>d.cat))].length}</div><div class="kpi-sub">${isCat ? 'nesta categoria' : 'grupos ativos'}</div></div>
    <div class="kpi fade-up" style="--kpi-color:var(--violet)"><div class="kpi-label">Itens nicos</div><div class="kpi-value">${data.length}</div><div class="kpi-sub">produtos distintos</div></div>
    <div class="kpi fade-up" style="--kpi-color:var(--rose)"><div class="kpi-label">Ticket Mdio</div><div class="kpi-value">${fmt(qty>0?total/qty:0)}</div><div class="kpi-sub">por unidade</div></div>
  `;

  // Category cards (s quando "Todas")
  const cardsEl = document.getElementById('v-cat-cards');
  if (cardsEl) {
    if (!isCat) {
      const catMap = {};
      VENDAS.forEach(d => { if(!catMap[d.cat]) catMap[d.cat]={val:0,qty:0}; catMap[d.cat].val+=d.val; catMap[d.cat].qty+=d.qty; });
      const cats = Object.entries(catMap).map(([n,v])=>({name:n,...v})).sort((a,b)=>b.val-a.val);
      cardsEl.style.display = '';
      cardsEl.innerHTML = cats.map((c,i) => `
        <div class="cat-summary-card" style="--cc:${COLORS[i%COLORS.length]}" onclick="setVendasCat(this)" data-val="${c.name.replace(/"/g,'&quot;')}">
          <div class="cscard-name">${c.name}</div>
          <div class="cscard-val">${fmt(c.val)}</div>
          <div class="cscard-sub">${fmtN(c.qty)} un  ${fmtP(c.val/totalAll*100)}</div>
        </div>`).join('');
    } else {
      cardsEl.style.display = 'none';
    }
  }

  // Destroy old charts
  ['v-bar','v-pie'].forEach(k => { if(charts[k]) { charts[k].destroy(); delete charts[k]; } });

  // Charts
  const chartsEl = document.getElementById('v-charts');
  if (chartsEl) {
    if (!isCat) {
      const catMap = {};
      data.forEach(d => { if(!catMap[d.cat]) catMap[d.cat]={val:0}; catMap[d.cat].val+=d.val; });
      const cats = Object.entries(catMap).map(([n,v])=>({name:n,...v})).sort((a,b)=>b.val-a.val);
      chartsEl.innerHTML = `
        <div class="panel"><div class="panel-hd"><span class="panel-title">Faturamento por Categoria</span></div><div class="chart-box"><canvas id="v-chart-bar"></canvas></div></div>
        <div class="panel"><div class="panel-hd"><span class="panel-title">Distribuio %</span></div><div class="chart-box"><canvas id="v-chart-pie"></canvas></div></div>`;
      setTimeout(() => {
        const b = document.getElementById('v-chart-bar'), p = document.getElementById('v-chart-pie');
        if (!b||!p) return;
        charts['v-bar'] = new Chart(b.getContext('2d'), { type:'bar', data:{ labels:cats.map(c=>c.name.length>16?c.name.slice(0,14)+'':c.name), datasets:[{data:cats.map(c=>c.val),backgroundColor:COLORS.map(c=>c+'bb'),borderColor:COLORS,borderWidth:1}] }, options:{responsive:true,plugins:{legend:{display:false},tooltip:{backgroundColor:'#111',callbacks:{label:c=>' '+fmt(c.raw)}}},scales:{x:{ticks:{color:'#5a5a52',font:{family:'DM Mono',size:8},maxRotation:40},grid:{color:'#1a1a1e'}},y:{ticks:{color:'#6b6b60',font:{family:'DM Mono',size:9},callback:v=>'R$'+(v/1000).toFixed(0)+'k'},grid:{color:'#1a1a1e'}}}}});
        charts['v-pie'] = new Chart(p.getContext('2d'), { type:'doughnut', data:{ labels:cats.map(c=>c.name), datasets:[{data:cats.map(c=>c.val),backgroundColor:COLORS.map(c=>c+'cc'),borderColor:'#09090a',borderWidth:2}] }, options:{responsive:true,plugins:{legend:{position:'bottom',labels:{color:'#6b6b60',font:{family:'DM Mono',size:9},boxWidth:10}},tooltip:{backgroundColor:'#111',callbacks:{label:c=>' '+fmt(c.raw)+' ('+fmtP(c.raw/total*100)+')'}}}}});
      }, 60);
    } else {
      // Top produtos da categoria em grfico de barras
      const sorted = [...data].sort((a,b)=>b.val-a.val).slice(0,15);
      chartsEl.innerHTML = `
        <div class="panel" style="grid-column:1/-1"><div class="panel-hd"><span class="panel-title">Top Produtos  ${activeCatVendas}</span></div><div class="chart-box"><canvas id="v-chart-bar" style="max-height:240px"></canvas></div></div>`;
      setTimeout(() => {
        const b = document.getElementById('v-chart-bar');
        if (!b) return;
        charts['v-bar'] = new Chart(b.getContext('2d'), { type:'bar', data:{ labels:sorted.map(d=>d.prod.length>22?d.prod.slice(0,20)+'':d.prod), datasets:[{data:sorted.map(d=>d.val),backgroundColor:'#d4a843bb',borderColor:'#d4a843',borderWidth:1}] }, options:{responsive:true,plugins:{legend:{display:false},tooltip:{backgroundColor:'#111',callbacks:{label:c=>' '+fmt(c.raw)}}},scales:{x:{ticks:{color:'#5a5a52',font:{family:'DM Mono',size:8},maxRotation:45},grid:{color:'#1a1a1e'}},y:{ticks:{color:'#6b6b60',font:{family:'DM Mono',size:9},callback:v=>'R$'+(v/1000).toFixed(0)+'k'},grid:{color:'#1a1a1e'}}}}});
      }, 60);
    }
  }

  // Rankings
  const ranksEl = document.getElementById('v-ranks');
  const topVal = [...data].sort((a,b)=>b.val-a.val).slice(0,15);
  const topQty = [...data].sort((a,b)=>b.qty-a.qty).slice(0,15);
  if (ranksEl) ranksEl.innerHTML = `
    <div class="panel"><div class="panel-hd"><span class="panel-title"> Top 15  Faturamento</span></div>
      <div class="rank-list">${topVal.map((d,i)=>`
        <div class="rank-item">
          <div class="rank-num ${i<3?'top':''}">${i<3?['','',''][i]:i+1}</div>
          <div class="rank-info"><div class="rank-name" title="${d.prod}">${d.prod}</div><div class="rank-cat">${isCat?fmtN(d.qty)+' un':d.cat}</div></div>
          <div class="rank-right"><div class="rank-val">${fmt(d.val)}</div><div class="rank-bar-wrap"><div class="rank-bar" style="width:${(d.val/topVal[0].val*100).toFixed(1)}%"></div></div></div>
        </div>`).join('')}
      </div>
    </div>
    <div class="panel"><div class="panel-hd"><span class="panel-title"> Top 15  Unidades</span></div>
      <div class="rank-list">${topQty.map((d,i)=>`
        <div class="rank-item">
          <div class="rank-num ${i<3?'top':''}">${i<3?['','',''][i]:i+1}</div>
          <div class="rank-info"><div class="rank-name" title="${d.prod}">${d.prod}</div><div class="rank-cat">${isCat?fmt(d.val):d.cat}</div></div>
          <div class="rank-right"><div class="rank-val" style="color:var(--green)">${fmtN(d.qty)} un</div><div class="rank-bar-wrap"><div class="rank-bar" style="width:${(d.qty/topQty[0].qty*100).toFixed(1)}%;background:var(--green)"></div></div></div>
        </div>`).join('')}
      </div>
    </div>`;

  // Table
  const tableEl = document.getElementById('v-table');
  const sorted = [...data].sort((a,b)=>b.val-a.val);
  if (tableEl) tableEl.innerHTML = `
    <div class="panel-hd"><span class="panel-title">Produtos${isCat?'  '+activeCatVendas:''}</span><span class="panel-badge">${data.length} itens</span></div>
    <div class="table-wrap"><table>
      <thead><tr><th>#</th><th>Produto</th>${!isCat?'<th>Categoria</th>':''}<th style="text-align:right">Qtde</th><th style="text-align:right">Faturamento</th><th style="text-align:right">% ${isCat?'Categoria':'Total'}</th></tr></thead>
      <tbody>${sorted.map((d,i)=>`<tr>
        <td class="td-num">${i+1}</td>
        <td style="color:var(--text)">${d.prod}</td>
        ${!isCat?`<td><span class="td-badge">${d.cat}</span></td>`:''}
        <td class="td-right">${fmtN(d.qty)}</td>
        <td class="td-val">${fmt(d.val)}</td>
        <td class="td-blue">${(d.val/total*100).toFixed(2)}%</td>
      </tr>`).join('')}
      </tbody>
    </table></div>`;
}

/* 
   COMPRAS PAGE
 */
function buildComprasPage() {
  activeFornCompras = 'all';
  document.getElementById('page-compras').innerHTML = `
    <div id="c-forn-filter" class="cat-filter-bar"></div>
    <div id="c-kpis" class="kpi-row"></div>
    <div id="c-forn-cards" class="cat-cards-grid"></div>
    <div id="c-charts" class="grid-2 mb20"></div>
    <div id="c-table" class="panel"></div>
  `;
  renderComprasFilter();
  renderComprasContent();
}

function renderComprasFilter() {
  const ferns = [...new Set(COMPRAS.map(d => d.supplier))].sort();
  const bar = document.getElementById('c-forn-filter');
  if (!bar) return;
  bar.innerHTML = [
    `<button class="cat-chip cat-chip-all ${activeFornCompras==='all'?'active':''}" onclick="setFornCompras(this)" data-val="all">Todos</button>`,
    ...ferns.map((f,i) => `<button class="cat-chip ${activeFornCompras===f?'active':''}" style="--chip-color:${COLORS[(i+2)%COLORS.length]}" onclick="setFornCompras(this)" data-val="${f.replace(/"/g,'&quot;')}">${f.length>28?f.slice(0,26)+'':f}</button>`)
  ].join('');
}

function setFornCompras(el) {
  activeFornCompras = el.dataset.val;
  renderComprasFilter();
  renderComprasContent();
}

function renderComprasContent() {
  const data     = activeFornCompras === 'all' ? COMPRAS : COMPRAS.filter(d => d.supplier === activeFornCompras);
  const total    = data.reduce((s,d) => s+d.val, 0);
  const totalQty = data.reduce((s,d) => s+d.qty, 0);
  const totalAll = COMPRAS.reduce((s,d) => s+d.val, 0);
  const isForn   = activeFornCompras !== 'all';

  // Consolidate products
  const prodMap = {};
  data.forEach(d => { if(!prodMap[d.prod]) prodMap[d.prod]={val:0,qty:0,sup:d.supplier}; prodMap[d.prod].val+=d.val; prodMap[d.prod].qty+=d.qty; });
  const prods = Object.entries(prodMap).map(([n,v])=>({name:n,...v})).sort((a,b)=>b.val-a.val);

  // Suppliers map (for "all" view)
  const supMap = {};
  COMPRAS.forEach(d => { if(!supMap[d.supplier]) supMap[d.supplier]={val:0,qty:0,count:0}; supMap[d.supplier].val+=d.val; supMap[d.supplier].qty+=d.qty; supMap[d.supplier].count++; });
  const sups = Object.entries(supMap).map(([n,v])=>({name:n,...v})).sort((a,b)=>b.val-a.val);

  // KPIs
  const kpisEl = document.getElementById('c-kpis');
  if (kpisEl) kpisEl.innerHTML = `
    <div class="kpi fade-up" style="--kpi-color:var(--teal)"><div class="kpi-label">Total em Compras</div><div class="kpi-value">${fmt(total)}</div><div class="kpi-sub">${isForn ? fmtP(total/totalAll*100)+' do total' : 'valor do perodo'}</div></div>
    <div class="kpi fade-up" style="--kpi-color:var(--green)"><div class="kpi-label">Unidades Compradas</div><div class="kpi-value">${fmtN(totalQty)}</div><div class="kpi-sub">itens adquiridos</div></div>
    <div class="kpi fade-up" style="--kpi-color:var(--blue)"><div class="kpi-label">${isForn ? 'Produtos Distintos' : 'Fornecedores'}</div><div class="kpi-value">${isForn ? prods.length : sups.length}</div><div class="kpi-sub">${isForn ? 'neste fornecedor' : 'fornecedores ativos'}</div></div>
    <div class="kpi fade-up" style="--kpi-color:var(--violet)"><div class="kpi-label">Registros</div><div class="kpi-value">${fmtN(data.length)}</div><div class="kpi-sub">linhas processadas</div></div>
    <div class="kpi fade-up" style="--kpi-color:var(--rose)"><div class="kpi-label">Ticket Mdio</div><div class="kpi-value">${fmt(data.length>0?total/data.length:0)}</div><div class="kpi-sub">por registro</div></div>
  `;

  // Supplier cards (s quando "Todos")
  const cardsEl = document.getElementById('c-forn-cards');
  if (cardsEl) {
    if (!isForn) {
      cardsEl.style.display = '';
      cardsEl.innerHTML = sups.map((s,i) => `
        <div class="cat-summary-card" style="--cc:${COLORS[(i+2)%COLORS.length]}" onclick="setFornCompras(this)" data-val="${s.name.replace(/"/g,'&quot;')}">
          <div class="cscard-name">${s.name.length>32?s.name.slice(0,30)+'':s.name}</div>
          <div class="cscard-val" style="font-size:1.1rem">${fmt(s.val)}</div>
          <div class="cscard-sub">${s.count} notas  ${fmtN(s.qty)} un  ${fmtP(s.val/totalAll*100)}</div>
        </div>`).join('');
    } else {
      cardsEl.style.display = 'none';
    }
  }

  // Destroy old charts
  ['c-sup','c-prod'].forEach(k => { if(charts[k]) { charts[k].destroy(); delete charts[k]; } });

  // Charts
  const chartsEl = document.getElementById('c-charts');
  if (chartsEl) {
    if (!isForn) {
      chartsEl.innerHTML = `
        <div class="panel"><div class="panel-hd"><span class="panel-title">Gasto por Fornecedor</span></div><div class="chart-box"><canvas id="c-chart-sup"></canvas></div></div>
        <div class="panel"><div class="panel-hd"><span class="panel-title">Top Fornecedores  Ranking</span></div>
          <div class="rank-list">${sups.slice(0,10).map((s,i)=>`
            <div class="rank-item">
              <div class="rank-num ${i<3?'top':''}">${i<3?['','',''][i]:i+1}</div>
              <div class="rank-info"><div class="rank-name" title="${s.name}">${s.name}</div><div class="rank-cat">${s.count} notas  ${fmtN(s.qty)} un</div></div>
              <div class="rank-right"><div class="rank-val" style="color:var(--teal)">${fmt(s.val)}</div><div class="rank-bar-wrap"><div class="rank-bar" style="width:${(s.val/sups[0].val*100).toFixed(1)}%;background:var(--teal)"></div></div></div>
            </div>`).join('')}
          </div>
        </div>`;
      setTimeout(() => {
        const ctx = document.getElementById('c-chart-sup');
        if (!ctx) return;
        charts['c-sup'] = new Chart(ctx.getContext('2d'), { type:'bar', data:{ labels:sups.slice(0,12).map(s=>s.name.length>18?s.name.slice(0,16)+'':s.name), datasets:[{data:sups.slice(0,12).map(s=>s.val),backgroundColor:COLORS.slice(2).map(c=>c+'bb'),borderColor:COLORS.slice(2),borderWidth:1}] }, options:{responsive:true,plugins:{legend:{display:false},tooltip:{backgroundColor:'#111',callbacks:{label:c=>' '+fmt(c.raw)}}},scales:{x:{ticks:{color:'#5a5a52',font:{family:'DM Mono',size:8},maxRotation:40},grid:{color:'#1a1a1e'}},y:{ticks:{color:'#6b6b60',font:{family:'DM Mono',size:9},callback:v=>'R$'+(v/1000).toFixed(0)+'k'},grid:{color:'#1a1a1e'}}}}});
      }, 60);
    } else {
      // Top produtos do fornecedor
      const top = prods.slice(0, 15);
      chartsEl.innerHTML = `
        <div class="panel" style="grid-column:1/-1"><div class="panel-hd"><span class="panel-title">Top Produtos  ${activeFornCompras.length>40?activeFornCompras.slice(0,38)+'':activeFornCompras}</span></div><div class="chart-box"><canvas id="c-chart-prod" style="max-height:240px"></canvas></div></div>`;
      setTimeout(() => {
        const ctx = document.getElementById('c-chart-prod');
        if (!ctx) return;
        charts['c-prod'] = new Chart(ctx.getContext('2d'), { type:'bar', data:{ labels:top.map(d=>d.name.length>22?d.name.slice(0,20)+'':d.name), datasets:[{data:top.map(d=>d.val),backgroundColor:'#3a8a8abb',borderColor:'#3a8a8a',borderWidth:1}] }, options:{responsive:true,plugins:{legend:{display:false},tooltip:{backgroundColor:'#111',callbacks:{label:c=>' '+fmt(c.raw)}}},scales:{x:{ticks:{color:'#5a5a52',font:{family:'DM Mono',size:8},maxRotation:45},grid:{color:'#1a1a1e'}},y:{ticks:{color:'#6b6b60',font:{family:'DM Mono',size:9},callback:v=>'R$'+(v/1000).toFixed(0)+'k'},grid:{color:'#1a1a1e'}}}}});
      }, 60);
    }
  }

  // Table
  const tableEl = document.getElementById('c-table');
  if (tableEl) tableEl.innerHTML = `
    <div class="panel-hd"><span class="panel-title">Produtos${isForn?'  '+activeFornCompras.slice(0,40):'  Consolidado'}</span><span class="panel-badge">${prods.length} itens</span></div>
    <div class="table-wrap"><table>
      <thead><tr><th>#</th><th>Produto</th>${!isForn?'<th>Fornecedor Principal</th>':''}<th style="text-align:right">Qtde</th><th style="text-align:right">Total</th><th style="text-align:right">% ${isForn?'Fornecedor':'Compras'}</th></tr></thead>
      <tbody>${prods.map((d,i)=>`<tr>
        <td class="td-num">${i+1}</td>
        <td style="color:var(--text)">${d.name}</td>
        ${!isForn?`<td><span class="td-badge">${d.sup.length>30?d.sup.slice(0,28)+'':d.sup}</span></td>`:''}
        <td class="td-right">${fmtN(d.qty)}</td>
        <td class="td-val" style="color:var(--teal)">${fmt(d.val)}</td>
        <td class="td-blue">${(d.val/total*100).toFixed(2)}%</td>
      </tr>`).join('')}
      </tbody>
    </table></div>`;
}

/* 
   COMISSES PAGE
 */
function buildComissoesPage() {
  const totalRealizado = COMISSOES.reduce((s,d) => s+d.realizado, 0);
  const totalEsperado  = COMISSOES.reduce((s,d) => s+d.esperado,  0);
  const totalRepique   = COMISSOES.reduce((s,d) => s+d.repique,   0);
  const totalReceber   = COMISSOES.reduce((s,d) => s+d.receber,   0);
  const totalAtend     = COMISSOES.reduce((s,d) => s+d.atendimentos, 0);
  const atingimento    = totalEsperado > 0 ? (totalRealizado / totalEsperado * 100) : 0;
  const sorted = [...COMISSOES].sort((a,b) => b.realizado - a.realizado);
  const periodo = COMISSOES.find(d => d.periodo)?.periodo || '';
  const temReceber = totalReceber > 0;

  // KPI receber ou atingimento dependendo do que tiver dado
  const kpiExtra = temReceber
    ? `<div class="kpi fade-up" style="--kpi-color:var(--violet)"><div class="kpi-label">A Receber</div><div class="kpi-value">${fmt(totalReceber)}</div><div class="kpi-sub">total comisses</div></div>`
    : `<div class="kpi fade-up" style="--kpi-color:var(--gold)"><div class="kpi-label">Repique Total</div><div class="kpi-value">${fmt(totalRepique)}</div><div class="kpi-sub">bnus acumulado</div></div>`;

  const html = `
    <div class="kpi-row">
      <div class="kpi fade-up" style="--kpi-color:var(--green)"><div class="kpi-label">Total Realizado</div><div class="kpi-value">${fmt(totalRealizado)}</div><div class="kpi-sub">vendas dos atendentes</div></div>
      <div class="kpi fade-up" style="--kpi-color:var(--muted)"><div class="kpi-label">Total Esperado</div><div class="kpi-value">${fmt(totalEsperado)}</div><div class="kpi-sub">meta do perodo</div></div>
      <div class="kpi fade-up" style="--kpi-color:${atingimento>=100?'var(--green)':'var(--rose)'}"><div class="kpi-label">Atingimento Geral</div><div class="kpi-value">${fmtP(atingimento)}</div><div class="kpi-sub">realizado / esperado</div></div>
      ${kpiExtra}
      <div class="kpi fade-up" style="--kpi-color:var(--blue)"><div class="kpi-label">Atendimentos</div><div class="kpi-value">${fmtN(totalAtend)}</div><div class="kpi-sub">${COMISSOES.length} atendentes</div></div>
    </div>
    ${periodo ? `<div style="font-size:9px;color:var(--muted);letter-spacing:.12em;margin-bottom:16px;text-transform:uppercase">Perodo: ${periodo}</div>` : ''}
    <div class="grid-2 mb20">
      <div class="panel">
        <div class="panel-hd"><span class="panel-title">Realizado vs Esperado</span></div>
        <div class="chart-box"><canvas id="com-chart"></canvas></div>
      </div>
      <div class="panel">
        <div class="panel-hd"><span class="panel-title">% Atingimento por Atendente</span></div>
        <div class="chart-box"><canvas id="com-chart-ating"></canvas></div>
      </div>
    </div>
    <div class="panel">
      <div class="panel-hd">
        <span class="panel-title">Detalhe por Atendente</span>
        <span class="panel-badge">${COMISSOES.length} atendentes  ${sorted.reduce((s,d)=>s+d.dias,0)} registros dirios</span>
      </div>
      <div class="table-wrap">
        <table>
          <thead><tr>
            <th>#</th><th>Atendente</th>
            <th style="text-align:right">Dias</th>
            <th style="text-align:right">Atend.</th>
            <th style="text-align:right">Esperado</th>
            <th style="text-align:right">Realizado</th>
            <th style="text-align:right">Atingimento</th>
            <th style="text-align:right">Repique</th>
            ${temReceber ? '<th style="text-align:right">A Receber</th>' : ''}
          </tr></thead>
          <tbody>${sorted.map((d,i) => {
            const ating = d.esperado > 0 ? (d.realizado / d.esperado * 100) : 0;
            const atingColor = ating >= 100 ? 'var(--green)' : ating >= 80 ? 'var(--gold)' : 'var(--rose)';
            return `<tr>
              <td class="td-num">${i+1}</td>
              <td style="color:var(--text)">${d.atendente}</td>
              <td class="td-right" style="color:var(--muted)">${d.dias}</td>
              <td class="td-right">${fmtN(d.atendimentos)}</td>
              <td class="td-right" style="color:var(--muted)">${fmt(d.esperado)}</td>
              <td class="td-green">${fmt(d.realizado)}</td>
              <td class="td-right" style="color:${atingColor};font-weight:500">${fmtP(ating)}</td>
              <td class="td-blue">${fmt(d.repique)}</td>
              ${temReceber ? `<td class="td-violet">${fmt(d.receber)}</td>` : ''}
            </tr>`;
          }).join('')}
          </tbody>
        </table>
      </div>
    </div>`;

  document.getElementById('page-comissoes').innerHTML = html;

  setTimeout(() => {
    const c1 = document.getElementById('com-chart');
    const c2 = document.getElementById('com-chart-ating');
    if (!c1 || !c2) return;

    const labels = sorted.map(d => d.atendente.split(' ')[0]);

    charts['com-1'] = new Chart(c1.getContext('2d'), {
      type: 'bar',
      data: { labels, datasets: [
        { label:'Realizado', data: sorted.map(d=>d.realizado), backgroundColor:'#4d9e6ebb', borderColor:'#4d9e6e', borderWidth:1 },
        { label:'Esperado',  data: sorted.map(d=>d.esperado),  backgroundColor:'#4a4a4255', borderColor:'#6b6b60',  borderWidth:1 },
      ]},
      options: { responsive:true, plugins:{ legend:{labels:{color:'#6b6b60',font:{family:'DM Mono',size:9},boxWidth:10}}, tooltip:{backgroundColor:'#111',callbacks:{label:ctx=>' '+fmt(ctx.raw)}} },
        scales:{ x:{ticks:{color:'#5a5a52',font:{family:'DM Mono',size:8},maxRotation:40},grid:{color:'#1a1a1e'}}, y:{ticks:{color:'#6b6b60',font:{family:'DM Mono',size:9},callback:v=>'R$'+(v/1000).toFixed(0)+'k'},grid:{color:'#1a1a1e'}} }}
    });

    // Atingimento % chart (horizontal bar)
    const atings = sorted.map(d => d.esperado > 0 ? +(d.realizado/d.esperado*100).toFixed(1) : 0);
    charts['com-2'] = new Chart(c2.getContext('2d'), {
      type: 'bar',
      data: { labels, datasets: [{
        label:'Atingimento %',
        data: atings,
        backgroundColor: atings.map(v => v>=100 ? '#4d9e6ebb' : v>=80 ? '#d4a843bb' : '#b05a4abb'),
        borderColor:     atings.map(v => v>=100 ? '#4d9e6e'   : v>=80 ? '#d4a843'   : '#b05a4a'),
        borderWidth: 1
      }]},
      options: { responsive:true, plugins:{ legend:{display:false},
        tooltip:{backgroundColor:'#111',callbacks:{label:ctx=>' '+ctx.raw+'%'}},
        annotation:{ annotations:[{type:'line',yMin:100,yMax:100,borderColor:'#6b6b60',borderWidth:1,borderDash:[4,4]}] }
      },
      scales:{
        x:{ticks:{color:'#5a5a52',font:{family:'DM Mono',size:8},maxRotation:40},grid:{color:'#1a1a1e'}},
        y:{ticks:{color:'#6b6b60',font:{family:'DM Mono',size:9},callback:v=>v+'%'},grid:{color:'#1a1a1e'},min:0}
      }}
    });
  }, 100);
}

/* 
   EXPORT
 */
function exportDashboard() {
  showToast('\u23f3 Gerando arquivo...', 4000);

  var injection =
    '<script id="bihub-data">' +
    'window.__BI_VENDAS__    = ' + JSON.stringify(VENDAS)    + ';' +
    'window.__BI_COMPRAS__   = ' + JSON.stringify(COMPRAS)   + ';' +
    'window.__BI_COMISSOES__ = ' + JSON.stringify(COMISSOES) + ';' +
    '<\/script>\n';

  // __SRC__  o outerHTML capturado ANTES de qualquer mutao do DOM.
  // Removemos injeo anterior (se existir) para no duplicar dados.
  var src = __SRC__.replace(/<script id="bihub-data">[\s\S]*?<\/script>\n?/g, '');

  // Garante que injeta no <head>  seja com ou sem atributos
  var result = src.replace(/<head([^>]*)>/, '<head$1>\n' + injection);

  _download(result);

  function _download(html) {
    var blob = new Blob([html], { type: 'text/html;charset=utf-8' });
    var url  = URL.createObjectURL(blob);
    var a    = document.createElement('a');
    a.href     = url;
    a.download = 'BI_Hub_espelho_' + new Date().toISOString().slice(0, 10) + '.html';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    setTimeout(function() { URL.revokeObjectURL(url); }, 2000);
    showToast('\u2713 Espelho gerado! Manda o .html para a pessoa abrir no navegador.');
  }
}

/*  INIT  */
/* __BIHUB_INIT__ */
checkSnaps();
updateViewButton();
// Auto-open se veio de um espelho exportado
if ((VENDAS.length + COMPRAS.length + COMISSOES.length) > 0) {
  ['vendas','compras','comissoes'].forEach(mod => {
    document.getElementById('tab-'+mod).classList.toggle('disabled', {vendas:VENDAS,compras:COMPRAS,comissoes:COMISSOES}[mod].length===0);
  });
  setTimeout(function(){ openBI(); }, 100);
}

// Chart.js global dark defaults
Chart.defaults.color = '#6b6b60';
Chart.defaults.borderColor = '#1e1e22';
Chart.defaults.backgroundColor = '#d4a84320';
</script>
</body>
</html>
